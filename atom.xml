<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[eugenius]]></title>
  <link href="http://eewang.github.com/atom.xml" rel="self"/>
  <link href="http://eewang.github.com/"/>
  <updated>2013-09-26T22:32:25-04:00</updated>
  <id>http://eewang.github.com/</id>
  <author>
    <name><![CDATA[Eugene Wang]]></name>
    <email><![CDATA[eugene.wang@flatironschool.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Presenting the Rails Presenter Pattern]]></title>
    <link href="http://eewang.github.com/blog/2013/09/26/presenting-the-rails-presenter-pattern/"/>
    <updated>2013-09-26T20:58:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/09/26/presenting-the-rails-presenter-pattern</id>
    <content type="html"><![CDATA[<p>The past few weeks have been pretty busy for me in terms of work. My team&#8217;s product schedule has been ramping up, and we&#8217;re right in the middle of rapidly prototyping both the customer-facing product and our editorial interface. Also, we recently added Backbone.js to our project, so I&#8217;ve been getting up to speed on how to integrate a client-side Javascript framework into a Rails application.</p>

<!--more-->


<p>I find adding Backbone to this project particularly exciting because I wrote most of the client-side functionality of our editorial interface in raw Javascript, so I&#8217;m more than happy to have the opportunity now to use Backbone to provide structure and cleaner interactivity. Much like how at Flatiron learning Ruby, SQL and Sinatra before turning to Rails made me appreciate all the work Rails does behind the scenes, implementing Backbone after having written less-than-stellar Javascript to create the same functionality makes me appreciate the value front-end frameworks like Backbone, Ember or Angular provide.</p>

<p>Outside of work, my development time has been mostly focused on <a href="http://www.litcharts.com" target="_blank">Litcharts</a> - a web and mobile platform for reviews and analysis of classic literature that was co-founded by a former fellow Flatironer and current NYTimes colleague, <a href="https://github.com/meowist" target="_blank">Justin Kestler</a>. My particular task has been to create a tool that builds newspaper-layout-like PDF versions of litcharts using HTML, CSS and Javascript. What seemed like a simple task - I initially thought I could just use CSS3 columns and a gem like Prawn or Wicked PDF - quickly turned complicated for a variety of reasons that I won&#8217;t go into at the moment. Needless to say, the past month or so has been quite busy for me with NYT and Litcharts work.</p>

<p>Consequently, the time available for me to blog has rapidly dwindled. I set a goal for myself to write one blog post a week as a way to motivate myself to keep learning code and exploring technology. What I&#8217;ve learned, though, is that after a program like Flatiron, where you&#8217;re immersed in code and laser focused on rapidly building an entirely new skill set, I&#8217;ve hit my stride with code in that its become a familiar extension of myself, like writing or reading. This means I can keep learning about code while living a more balanced lifestyle than I did at Flatiron; I can&#8217;t imagine that the countless hours spent writing, reading and talking about code in school is particularly sustainable in the long run.</p>

<p>But now back to the code. I recently implemented the Presenter pattern in my team&#8217;s Rails application. For those not familiar with the Presenter pattern, its a way to keep your view and controller logic as clean as possible by having a Ruby class serve as the interface between your model and the view/controller. Another way to think of a Presenter in Rails is as a serializer for your Views. And much like how ActiveModel::Serializers enable you to build a clean API and encapsulate API logic within methods that are easily testable, Presenters keep your model-specific view logic in one class that you can test like you would any other Rails model.</p>

<p>Imagine you have an Article class that represents a newspaper article. Articles each have associated multimedia elements, which can vary from an image, video or slideshow. For the sake of this post, an article is a stripped down model that just stores a serialized hash to represent the associated multimedia assets.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Article</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">serialize</span> <span class="ss">:multimedia</span><span class="p">,</span> <span class="no">Hash</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The multimedia attribute looks something like this when serialized.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="ss">:caption</span> <span class="o">=&gt;</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">:credit</span> <span class="o">=&gt;</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">:images</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="ss">:small</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>      <span class="ss">:url</span> <span class="o">=&gt;</span> <span class="s1">&#39;http://nytimes.com/image-small.jpg&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="ss">:dimensions</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>        <span class="ss">:height</span> <span class="o">=&gt;</span> <span class="mi">500</span><span class="p">,</span>
</span><span class='line'>        <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">500</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="ss">:large</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>      <span class="ss">:url</span> <span class="o">=&gt;</span> <span class="s1">&#39;http://nytimes.com/image-large.jpg&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="ss">:dimensions</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>        <span class="ss">:height</span> <span class="o">=&gt;</span> <span class="mi">500</span><span class="p">,</span>
</span><span class='line'>        <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">500</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="ss">:videos</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="ss">:small</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>      <span class="ss">:preview</span> <span class="o">=&gt;</span> <span class="s1">&#39;http://nytimes.com/video.m4v&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="ss">:dimensions</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>        <span class="ss">:height</span> <span class="o">=&gt;</span> <span class="mi">300</span><span class="p">,</span>
</span><span class='line'>        <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">400</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>In my views and controllers, I need to be able to access the urls and dimensions of each multimedia asset to render a preview of the asset. One option to get these attributes is to do a whole bunch of type checking within my views and access the url of an image as follows:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@article</span> <span class="o">=</span> <span class="no">Article</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="vi">@article</span><span class="o">.</span><span class="n">multimedia</span><span class="o">[</span><span class="ss">:images</span><span class="o">][</span><span class="ss">:small</span><span class="o">][</span><span class="ss">:url</span><span class="o">]</span> <span class="c1"># =&gt; http://nytimes.com/image-small.jpg</span>
</span></code></pre></td></tr></table></div></figure>


<p>Rather than have the logic in the controller or view, the Presenter pattern provides a Ruby class that wraps a Rails model in order to create a simple API to the underlying object. Rather than going through the hash in my view, what I want to be able to do is just call #url or #caption on my article instance and get back the necessary information. I can add methods to my ArticlePresenter class to semantically access multimedia urls in my controllers and views rather than constantly checking a key-value pair in a deep nested hash.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ArticlePresenter</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">DEFAULT_FORMAT</span> <span class="o">=</span> <span class="s1">&#39;small&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">FORMAT_TYPES</span> <span class="o">=</span> <span class="o">[</span><span class="ss">:small</span><span class="p">,</span> <span class="ss">:large</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">article</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@article</span> <span class="o">=</span> <span class="n">article</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">FORMAT_TYPES</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>    <span class="n">define_method</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">format</span><span class="si">}</span><span class="s2">_image_url&quot;</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@article</span><span class="o">.</span><span class="n">multimedia</span><span class="o">[</span><span class="ss">:images</span><span class="o">][</span><span class="nb">format</span><span class="o">][</span><span class="ss">:url</span><span class="o">]</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">define_method</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">format</span><span class="si">}</span><span class="s2">_video_url&quot;</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@article</span><span class="o">.</span><span class="n">multimedia</span><span class="o">[</span><span class="ss">:videos</span><span class="o">][</span><span class="nb">format</span><span class="o">][</span><span class="ss">:url</span><span class="o">]</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="n">type</span> <span class="o">=</span> <span class="ss">:image</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@article</span><span class="o">.</span><span class="n">multimedia</span><span class="o">[</span><span class="n">type</span><span class="o">][</span><span class="no">DEFAULT_FORMAT</span><span class="o">][</span><span class="ss">:url</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">caption</span>
</span><span class='line'>    <span class="vi">@article</span><span class="o">.</span><span class="n">caption</span> <span class="o">||</span> <span class="s2">&quot;No caption&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># ... Other presenter methods</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">method_missing</span><span class="p">(</span><span class="nb">method</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@article</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">method</span><span class="p">)</span> <span class="k">rescue</span> <span class="kp">nil</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This way, in my controller I can wrap each article in a collection in an ArticlePresenter instance, so that in my views I just need to call @article.small_image_url or @article.large_video_url to get what I need rather than checking the multimedia hash. Both ways get the same result, but using a Presenter provides a testable object-oriented interface for view-specific logic relevant to a Rails model.</p>

<p>And like ActiveModel::Serializers, I can set default values for nil return without having to change the underlying data. In this example, if an article multimedia item doesn&#8217;t have a caption, instead of returning nil to the view, I can instead return a string, &#8220;No caption&#8221;. This helps tailor your model instance to specific views without adding unwiedly logic to your ERB/HAML templates.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ArticleController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="vi">@articles</span> <span class="o">=</span> <span class="no">Article</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">article</span><span class="o">|</span> <span class="no">ArticlePresenter</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">article</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>One question I had when exploring the Presenter pattern was how it differed from plain old Rails helpers. I think Presenters are useful when you have logic specific to your models that you need encapsulated, whereas Rails view helpers are intended for more generic logic that is model agnostic, like converting dates or measurements. Of course, you could probably use view helpers to accomplish the same function as Presenters, but having a one-to-one relationship between a Presenter and its model feels cleaner to me.</p>

<p>Here are a few links that I found helpful while implementing the Presenter pattern.</p>

<p><a href="http://blog.jayfields.com/2007/03/rails-presenter-pattern.html" target="_blank">Jay Fields on the Presenter Pattern</a></p>

<p><a href="http://www.derekhammer.com/2012/11/06/a-pattern-for-rails-presenters" target="_blank">A Pattern for Rails Presenters</a></p>

<p><a href="http://www.tamingthemindmonkey.com/2012/04/10/exploring-the-presenter-pattern" target="_blank">Exploring the Presenter Pattern</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Thoughts on Windy City Rails, Day 1]]></title>
    <link href="http://eewang.github.com/blog/2013/09/12/thoughts-on-windy-city-rails/"/>
    <updated>2013-09-12T20:06:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/09/12/thoughts-on-windy-city-rails</id>
    <content type="html"><![CDATA[<p>I have the good fortune to be in Chicago today and tomorrow for the <a href="http://www.windycityrails.org/" target="_blank">Windy City Rails</a> conference. The NYT was kind enough to pay for me to fly here and attend the conferece, and I&#8217;m sure it helps that I can crash with my brother in the south Loop rather than get a hotel room. Whenever I can get the chance to come back home and see my family and friends, I try to jump at the opportunity.</p>

<p>Here are some thoughts on the most interesting talks I heard on WCR Day 1.</p>

<!--more-->


<h4>&#8220;Functional Principles for Ruby Developers&#8221; by <a href="https://twitter.com/jessitron" target="_blank">Jessica Kerr</a></h4>

<p>Functional programming is pretty much a black box to me. I&#8217;ve heard a lot about it and know about the languages that implement it, but don&#8217;t quite understand how it works or what the tradeoffs are compared to the more familiar object-oriented programming paradigm. As a Scala and Ruby developer, Jessica spoke about the core tenets of functional programming, and how they can be applied to Ruby and Rails. Her talk was the one I found most insightful and helpful for me personally on Day 1, and I liked how she used a simple, self-contained example (a Ruby script to calculate the total price of a set of data on books in .csv format) that demonstrated in code the broad themes she touched on.</p>

<p><em>Data In, Data Out</em></p>

<p>This seems to be the fundamental aspect of <a href="http://en.wikipedia.org/wiki/Functional_programming" target="_blank">functional programming</a>. Functions are intended to be black boxes that take in data, do some awesome calculations, then return some other data. Personally, I need to see more code examples / translations into functional programming in order to fully grasp what&#8217;s going on, but I get how functional programming can help improve the predictability of an application&#8217;s behavior by removing or minimizing state dependency and the impact within a function on the outside environment. Pat Shaughnessy gave a <a href="http://www.youtube.com/watch?v=5ZjwEPupybw" target="_blank">great talk</a> on functional programming and Ruby using Haskell as a foil at GORUCO 2013. Jessica&#8217;s talk helps solidify some of my understanding of functional programming after hearing about it (and having it fly over my head) at GORUCO.</p>

<p><em>Functions are data</em></p>

<p>Lambdas in Ruby serve as first-class functions, not blocks or procs. Functions that are first-class can be stored as variables, passed around as parameters and set as the return value from other functions. An example of this is in how lambdas handle return or break statements. Return in a lambda exits the immediately executing scope to the parent environment, whereas blocks and procs exit out of the scope above them. Functions in a functional programming context are intended to be complete black boxes - data comes in, something happens, and data comes out. Lambdas are more accurate reflections of this functional programming construct than the other pseudo-function elements like blocks or procs.</p>

<p><em>Errors are data too</em></p>

<p>This relates with the item below - basically, that the more information you have about why your program isn&#8217;t working, the more likely you&#8217;ll be able to get your program to work. Standard error messages include stack traces and specific indications of why your code is broken (NoMethodError, for example, pretty succinctly tells you that you&#8217;re calling a method that doesn&#8217;t apply). Coders should try and add in their own custom error messages to describe why their program doesn&#8217;t work. In Jessica&#8217;s example, instead of trusting the program to sum up all the prices of the books, adding custom error messages helps in debugging and indicating whether the program didn&#8217;t work properly because the book didn&#8217;t have an ISBN number or that it didn&#8217;t have a price.</p>

<p><em>Nil is not data</em></p>

<p>Nil means a lot of things in Ruby - it&#8217;s pretty much the catch-all return value for whenever something doesn&#8217;t go according to plan. You search for a non-existent key in a hash (nil!). You have an if-statement without an explicit else block (nil!). You try to access an array index greater than the size of the array itself (nil!). All of these use cases demonstrate the ubiquity of nil so much so that if nil means everything, it also means nothing.</p>

<p>Jessica demonstrated a way to convert nil values into meaningful messages that specify what exactly happened. For example, adding custom error messages and returing those as the script is running is more informative than just returning nil. This way, you know where your data is dirty and how you can further address it. She goes into more detail in her Github repo with the presentation (which I defintely recommend checking out).</p>

<p><em>Functional composition</em></p>

<p>Composition in functional programming refers to a &#8216;fits together with&#8217; type whereas composition in object-oriented programming is a &#8216;has a relationship with&#8217; type. For example, in order to print useful tracing messages, try and wrap functions in a helper method that prints out an error message and then calls the function itself. This is easier and DRYer than going into each of your methods and writing out messages, since if you want to change how you print the message, you only have to modify the body of one function rather than several.</p>

<p><em>Be Lazy</em></p>

<p>This goes without saying in general, but in this example speciically, the #lazy method in the Enumerable class helps evaluate one book. Without laziness, the process goes - import all book lists, check all prices, get all validly formatted books, then summing all the prices. With laziness, each book is processed end-to-end at a time. This way, the memory imprint of the process is minimized, and the sum builds up incrementally rather than being calculated all at once at the very end of the process. I liken the laziness aspect to scaling vertically rather than horizontally - its generally smarter (and much easier) to do the former than the latter.</p>

<p>I had not known previously about the <a href="https://github.com/yhara/enumerable-lazy" target="_blank">#lazy</a> Enumerable method, and it looks like a nifty component added in Ruby 2.0, so I&#8217;ll definitely be sure to try and play around with it wherever I can.</p>

<p>Here are a few helpful links - Jessica&#8217;s Github repo about the example she used is pretty descriptive of the benefits of functional programming with Ruby coming from a non-Rubyist perspective.</p>

<p><a href="https://github.com/jessitron/fp4rd" target="_blank">Why should a Rubyist care about functional programming?</a></p>

<p><a href="http://www.confreaks.com/videos/2382-rmw2013-functional-principles-for-oo-development" target="_blank">Functional Principles for OO Development (Ruby Midwest)</a></p>

<h4>&#8220;Devs and Depression&#8221; by <a href="https://twitter.com/greggyb">Greg Baugues</a></h4>

<p>This talk by Greg Baugues was probably the most unique talk I heard all day, largely because it didn&#8217;t deal directly with code. Greg shared his personal struggle with bipolar disorder and ADD, and spoke about how certain qualities like intense focus and grandiose thoughts displayed by developers can actually reflect a deeper, unhealthy state. As someone with loved ones who have been afflicted by depression, I appreciated the honest look Greg provided into how mental health issues can debilitate one&#8217;s capacity for creativity and productivity. Go check out <a href="http://www.devsanddepression.com/" target="_blank">this site</a> about his depression.</p>

<h4>&#8220;Keeping Your Massive Rails App From Turning Into a S#!t Show&#8221; by <a href="https://twitter.com/benjamin_smith" target="_blank">Benjamin Smith</a></h4>

<p>Service-oriented architecture seems to be all the rage these days, and Ben (of Pivotal Labs) described the process they used to build a complex social networking application using self-contained Rails engines. By breaking out the circular dependencies that are common across Rails (e.g., User has many Posts; Posts belongs to User), they were able to avoid having a monolithic User model and instead bolt-on added functionality (e.g., comments, likes, photos, etc.) in a discrete and loosely coupled manner without adding unwieldly dependencies.</p>

<p>I haven&#8217;t used <a href="http://edgeguides.rubyonrails.org/engines.html" target="_blank">Rails engines</a> before, but they seem like nifty structural components to keeping code self-contained and modular so that separate teams can work on sub-sections of an application in relative isolation. One of the drawbacks of this technique, though, was that the initial velocity of the project was low, as they were focusing a lot on ensuring structural efficiency. However, this more than paid off as the project scaled, because they could add features incrementally without having to worry about dependencies across the project.</p>

<h4>&#8220;Hardware Integration with Rails&#8221; by <a href="https://twitter.com/too_mitch" target="_blank">Mitch Lloyd</a></h4>

<p>Mitch, who works at a development shop out of Pittsburgh called Gaslight, covered the basics of dealing with hardware using Ruby. He walked the group through converting Ruby messages into binary using basic &#8216;to_i&#8217; commands with varying bases (default is base 10) to send the proper messages to the hardware receiver. Having never worked with hardware before, I appreciated his zero-baseline approach to teaching hardware programming, but I frankly got a little lost when he moved on to managing asynchronous tasks between software sender and hardware receiver and multi-threading. These are topics that I need more experience in - don&#8217;t worry though, they&#8217;re on my list of technical areas to explore.</p>

<p>Having gone to a grand total of two technical programming conferences (represent GORUCO 2013!), I&#8217;m starting to get a feel for what I like and don&#8217;t like in technical talks.</p>

<p><strong>Likes:</strong> Small, self-contained code sample or example application that demonstrates the main themes of the talk. Coherent presentation structure (bulleted &#8216;takeaways&#8217; are an easy way to accomplish this). Description of both anti-pattern and pro-pattern (e.g., &#8220;this is what y&#8217;all are doing&#8230; but this is how y&#8217;all should be doing it&#8221;). Keep presentations to 30 minutes, max. Maybe 45 minutes, but you&#8217;re really pushing it then.</p>

<p><strong>Dislikes:</strong> Presenters who are too abstract and don&#8217;t deal with code implementation details about what they&#8217;re advocating. Presenters who are too detailed and don&#8217;t convert the code they&#8217;re writing to broader abstract themes. Bad jokes that fall flat on the audience.</p>

<p>I&#8217;ll see what today brings, but overall I&#8217;ve enjoyed my time at Windy City Rails. The talks have covered a wide swath of topics - from testing, to functional programming, to mental health issues. One downside of the conference, though, was that it held at the South Shore Convention Center, south of the University of Chicago. For those not familiar with Windy City geography, that&#8217;s like holding GORUCO out in Pelham Bay Park in the Bronx - a beautiful area with natural scenery and fresh air, but a bit away from the bustling city center. I wish Windy City Rails were held right in the Loop, not only for my own commuting convenience but more so for those who haven&#8217;t really seen Chicago and want to explore the great city I call home (disclaimer: I&#8217;m actually from Naperville, a suburb of Chicago, but no one needs to mention that :)).</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Applying Vector Bitmask Fields in Rails]]></title>
    <link href="http://eewang.github.com/blog/2013/08/31/applying-vector-bitmask-fields-in-rails/"/>
    <updated>2013-08-31T12:49:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/08/31/applying-vector-bitmask-fields-in-rails</id>
    <content type="html"><![CDATA[<p>I&#8217;ve been using a gem called <a href="https://github.com/pboling/flag_shih_tzu" target="_blank">Flag Shih-Tzu</a> in a number of my projects
recently. In addition to being a wonderfully (and aptly) named gem,
FlagShihTzu makes it super simple to add bit mask fields, or Boolean
indicators, without having to run additional migrations. In other
words, it allows you to flag shit on your models and makes it easier to avoid technical debt when there is little certainty of an application&#8217;s trajectory.</p>

<!--more-->


<p>When I first heard about <a href="http://en.wikipedia.org/wiki/Bit_array" target="_blank">vector bit fields</a> at 8to18 Media, I&#8217;ll admit that they sounded intimidating. Its a pretty computer scienc-ey sounding term - vectors! bits! technology! But in reality, they&#8217;re pretty much just an array of zeroes and ones, and the position of those bits in an array map to a vector legend. Imagine you have a 1 or 0 in each position of an array of size 3. A &#8216;1&#8217; in the first position indicates 2 ^ 0, a &#8216;1&#8217; in the second position is equal to 2 ^ 1, and a &#8216;1&#8217; in the third position is 2 ^ 2. That way, an array of [1, 0, 1] is equal to 2 ^ 0 + 2 ^ 2, or 5. Similarly, an array of [1, 1, 0] is equal to 3, and an array of [0, 1, 0] is equal to 2. Vector bitmasks (a.k.a. bit arrays) are a fairly elegant way to keep track of boolean, on-off switch attributes. <a href="http://devblog.xing.com/ruby-on-rails/a-rails-plugin-to-store-a-collection-of-boolean-values-as-a-single-bit-field/" target="_blank">Here&#8217;s</a> a helpful short blog post explaining bit fields.</p>

<p>What the FlagShihTzu gem does is basically convert an integer field in your
database table to a vector of bit masks. Based on the mapping
structure that you define in the relevant model, FlagShihTzu will
set and get the necessary bit fields and give you a bunch if useful
helper methods to enable you to plan effectively for horizontal scale
in your schema. Without this gem and without rolling your own similar
functionality, adding Boolean indicators means running a new migration
and getting methods set up for each new field. This can be mitigated
by using define_method or method_missing, but adding in a gem provides
the useful functionality without adding unwieldy dependencies.</p>

<p>Getting set-up with the gem is pretty standard - set up a Rails app and add it to the Gemfile. I&#8217;ve had to think a lot about apartments and housing in general in the last few weeks (searching for an apartment in the East Village and helping friends move will do that), so I figured I could use the domain of apartment and housing search for my example app. The more I&#8217;ve thought about it, the more I think the real estate area is a pretty good domain model - its something everyone is familiar with, and especially in the case of explaining bit fields, has a slew of reasonable use cases for boolean attributes.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails new nyc_apts
</span></code></pre></td></tr></table></div></figure>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Gemfile</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;flag_shih_tzu&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After running bundle install, add a model and create your database table. FlagShihTzu will automatically look for a column named &#8216;flags&#8217; unless you explicitly tell it to use a different column for the vector bitmask. In my project, I set the :columns option in my Building model to &#8216;amenities&#8217;. This way, FlagShihTzu will change the value of my &#8216;amenities&#8217; integer field as I set my boolean attributes.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails generate model apartment
</span></code></pre></td></tr></table></div></figure>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># in db/migrate</span>
</span><span class='line'><span class="k">class</span> <span class="nc">CreateBuildings</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Migration</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">change</span>
</span><span class='line'>    <span class="n">create_table</span> <span class="ss">:buildings</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">integer</span>  <span class="ss">:amenities</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">string</span>   <span class="ss">:address</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">string</span>   <span class="ss">:building_structure</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">string</span>   <span class="ss">:leasing_company</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">string</span>   <span class="ss">:description</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">string</span>  <span class="ss">:phone_number</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">integer</span> <span class="ss">:year_built</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">timestamps</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>After running rake db:migrate, I can add the following code to my building.rb file to tell it to use the FlagShihTzu functionality in my Building model.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># app/models/building.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Building</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">FlagShihTzu</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">has_flags</span> <span class="mi">1</span> <span class="o">=&gt;</span> <span class="ss">:pets_allowed</span><span class="p">,</span>
</span><span class='line'>                      <span class="mi">2</span> <span class="o">=&gt;</span> <span class="ss">:doorman</span><span class="p">,</span>
</span><span class='line'>                      <span class="mi">3</span> <span class="o">=&gt;</span> <span class="ss">:elevator</span><span class="p">,</span>
</span><span class='line'>                      <span class="mi">4</span> <span class="o">=&gt;</span> <span class="ss">:laundry</span><span class="p">,</span>
</span><span class='line'>                      <span class="ss">:column</span> <span class="o">=&gt;</span> <span class="s1">&#39;amenities&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note that once you choose an order for your flags, you cannot change them. Because the gem converts an integer into an array of bits, changing the mapping of the bit positions will yield different results for the same integer value.</p>

<p>That&#8217;s all you need to add to your model in order to start playing around with the gem. In the background, FlagShihTzu adds an slew of useful methods for setting, getting and checking your boolean attributes. Specifically, these are the ones I find most useful. The documentation on Github has more instance methods, but I haven&#8217;t found much use for them so far in my projects.</p>

<ul>
<li>Building#doorman</li>
<li>Building#doorman?</li>
<li>Building#doorman=</li>
<li>Building#doorman_changed?</li>
</ul>


<p>In my rails console, I can execute the following commands to quickly set my amenities column value using semantic setters for my boolean attributes.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>001:0 &gt; <span class="nv">building</span> <span class="o">=</span> Building.new
</span><span class='line'><span class="o">=</span>&gt; <span class="c">#&lt;Building id: nil, amenities: nil, address: nil, building_structure: nil, leasing_company: nil, description: nil, phone_number: nil, year_built: nil, created_at: nil, updated_at: nil&gt;</span>
</span><span class='line'>002:0 &gt; building.doorman?
</span><span class='line'><span class="o">=</span>&gt; <span class="nb">false</span>
</span><span class='line'>003:0 &gt; building.pets_allowed?
</span><span class='line'><span class="o">=</span>&gt; <span class="nb">false</span>
</span><span class='line'>004:0 &gt; building.doorman <span class="o">=</span> <span class="nb">true</span>
</span><span class='line'><span class="o">=</span>&gt; <span class="nb">true</span>
</span><span class='line'>005:0 &gt; building.amenities
</span><span class='line'><span class="o">=</span>&gt; 2
</span><span class='line'>006:0 &gt; building.pets_allowed <span class="o">=</span> <span class="nb">true</span>
</span><span class='line'><span class="o">=</span>&gt; <span class="nb">true</span>
</span><span class='line'>007:0 &gt; building.amenities
</span><span class='line'><span class="o">=</span>&gt; 3
</span></code></pre></td></tr></table></div></figure>


<p>Also, calling &#8216;has_flags&#8217; within your model produces class scopes that are useful for getting all instances of a Building that have doormen, for example. These method scopes are pretty straight forward - Building#doorman and Building#not_doorman, for example, will return an ActiveRecord Relation of all model instances that do or do not have the #doorman attribute set to true.</p>

<p>Although FlagShihTzu provides useful methods for setting and getting individual boolean attributes, I&#8217;ve been adding additional methods to set multiple attributes. For example, here are methods that allow for setting and getting attributes in bulk.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># app/models/building.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Building</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">set_building_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">list_name</span><span class="p">)</span>
</span><span class='line'>    <span class="n">flag_bits</span> <span class="o">=</span> <span class="n">flags</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">flag</span><span class="o">|</span> <span class="no">Building</span><span class="o">.</span><span class="n">flags</span><span class="p">(</span><span class="n">list_name</span><span class="o">.</span><span class="n">to_sym</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">to_sym</span><span class="p">)}</span>
</span><span class='line'>    <span class="n">list_bitmask</span> <span class="o">=</span> <span class="n">flag_bits</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">sum</span><span class="p">,</span> <span class="n">item</span><span class="o">|</span> <span class="n">sum</span> <span class="o">+</span> <span class="mi">2</span><span class="o">**</span><span class="n">item</span> <span class="p">}</span>
</span><span class='line'>    <span class="nb">send</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">list_name</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">,</span> <span class="n">list_bitmask</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">flags</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</span><span class='line'>    <span class="no">Building</span><span class="o">.</span><span class="n">flag_mapping</span><span class="o">[</span><span class="n">column</span><span class="o">.</span><span class="n">to_s</span><span class="o">].</span><span class="n">keys</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">flag_setting</span><span class="p">(</span><span class="n">setting</span><span class="p">,</span> <span class="n">list</span><span class="p">)</span>
</span><span class='line'>    <span class="n">list</span><span class="o">.</span><span class="n">reject</span> <span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="o">|</span> <span class="p">((</span><span class="n">setting</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">2</span><span class="o">**</span><span class="n">list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="o">.</span><span class="n">zero?</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">amenities_list</span>
</span><span class='line'>      <span class="n">flag_setting</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">amenities</span><span class="p">,</span> <span class="no">Building</span><span class="o">.</span><span class="n">flags</span><span class="p">(</span><span class="ss">:amenities</span><span class="p">))</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The #set_building_flags accepts an array of flags and an integer bitmask column in your database table and will set column appropriately. Similarly, #amenities_list takes advantage of the #flag_setting method to return the list of amenities a building instance has rather than just the integer value of the bitmask field.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>001:0 &gt; <span class="nv">a</span> <span class="o">=</span> Building.new
</span><span class='line'>002:0 &gt; a.set_building_flags<span class="o">([</span>:elevator, :laundry<span class="o">]</span>, :amenities<span class="o">)</span>
</span><span class='line'><span class="o">=</span>&gt; 12
</span><span class='line'>003:0 &gt; a.amenities_list
</span><span class='line'><span class="o">=</span>&gt; <span class="o">[</span>:elevator, :laundry<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Also, the #flags class method extends the #flag_mapping class method provided by the gem by checking the hash that gets returned by the #flag_mapping method and returning the list of possible boolean indicators for the given column.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>001:0 &gt; Building.flags<span class="o">(</span>:amenities<span class="o">)</span>
</span><span class='line'><span class="o">=</span>&gt; <span class="o">[</span>:pets_allowed, :doorman, :elevator, :laundry<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pretty straightforward stuff. Using FlagShihTzu in my projects has been a pretty lightweight way to add functionality that is easy to extend as my project grows. This way, adding new boolean indicators only requires one extra line of code in my model files, rather than running a new migration each time, which can quickly get unwiedly, especially for a young project that has not fully been fleshed out.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Navigating the Job Search]]></title>
    <link href="http://eewang.github.com/blog/2013/08/26/navigating-the-job-search/"/>
    <updated>2013-08-26T07:24:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/08/26/navigating-the-job-search</id>
    <content type="html"><![CDATA[<p>Last Friday was graduation day for the most recent cohort of Flatiron School students, and today is the first official day of the post-school job search process. I&#8217;m reminded of the my first day after the last day of Flatiron, when I went back into school just out of habit and a desire to continue the accelerated learning process that I had become so accustomed to. In light of that and with an eye toward helping out the newly-minted Flatiron graduates, here are a few thoughts that I hope can be useful to those who are enduring the frustration, anxiety and, ultimately and hopefully, joy of looking for a junior-level developer gig.</p>

<!--more-->


<p><strong>Don&#8217;t stress out about it!</strong></p>

<br>


<p>Its easy for me to say this from the perch of employment, but anxiety about finding a job can be counter productive. If you find joy in what you&#8217;re doing so much so that you continue to do it in your free time or practice it now that school is done, the job offers will inevitably come. Stress should be a motivating factor to seek out opportunities and explore the start-up landscape; it shouldn&#8217;t devolve into worry and anxiety about where your career will go or whether or not you&#8217;ll go hungry. The best careers seem to progress in a non-linear fashion - every other step seems to be sideways and sometimes even backwards. So don&#8217;t worry if it doesn&#8217;t seem like things are going your way early on, just pursue opportunities to learn new things, continue to write and blog and be as vocal about what you don&#8217;t know and want to learn as you are about what you already can accomplish.</p>

<p><strong>Know what you&#8217;re looking for</strong></p>

<br>


<p>Granted, that&#8217;s not especially useful advice. Knowing what your looking for seems to be an oxymoron - if I already know what I&#8217;m looking for, why would I need to be looking for it? What I mean here is not to have in mind already what the ideal job is, but rather know what you want to be characteristics of that ideal job. Are you passionate about something other than code? Go find a music startup or media company to work at. Are you looking to build rock-solid fundamentals in test-driven development and pair program daily? Go seek out a reputable dev shop. Coming out of a school like Flatiron you have a lot of opportunities, and as all sectors of the economy rapidly digitize and incorporate technology into their products and services, the demand is outpacing the supply of new engineers and developers. And even though positive churn (i.e., developers frequently changing companies for better opportunities) seems common in the technology space, your first job as a developer will invariably have an indelible impact on your future career in technology.</p>

<p><strong>There&#8217;s a whole lot more out there than Ruby&#8230;</strong></p>

<br>


<p>Its clear that Ruby is the lingua franca at Flatiron, as well as many of the other new development schools that are popping up. In the real world though, its just one of many languages that are used to solve engineering problems. At the New York Times, I encounter engineers who are skilled across a range of languages and frameworks, and many do not have Ruby experience. The NYT is a truly polyglot organization - everything from Python to C to Javascript to Go are used to solve the technical challenges of the NYT. Although its great to be an unabashed Rubyist, at the same time its important to understand the criticisms of Ruby and the benefits of a more statically typed language like C or Java. For me, I&#8217;ve learned how different languages really are built for different problems, even if a scripting language like Ruby has applications beyond the web development purposes that so many people use it for today.</p>

<p><strong>&#8230;Yet if you&#8217;re applying for a Rails job, know your Ruby</strong></p>

<br>


<p>One thing the TAs at Flatiron really emphasized that stuck with me was the importance of knowing core Ruby rather than just Rails. Understanding Ruby will help you better understand Rails, but the opposite isn&#8217;t always true. A mature framework like Rails can sometimes make it feel like you&#8217;re just configuring a system or adding magical keywords into your classes rather than actual programming. But at its core, Rails is just Ruby code - it can be extended, modified, pushed and pulled. The more you understand Ruby, the easier it will be to understand how gems or other bits of code can integrate into a piece of software.</p>

<p>Plus, knowing Ruby is good just for job interviews. Most of my technical interviews were focused on Ruby rather than Rails. And if they were focused on Rails, they were typically more high-level, software design questions that happened to use Rails as the development framework. In other words, I would either get questions like, &#8220;How would you sort this array and extract just every third word in Ruby?&#8221; or, &#8220;How would you build a software platform like Kickstarter?&#8221; Knowing Ruby is instrumental (and Rails pretty useless) to answering the former. Yet the latter can be reasoned through by understanding model associations and software design, rather than knowing how to apply specific macros in Rails. Obviously, understanding Rails will be critical for building software if you go to a Rails shop, but in the interview process, its better to walk in as a confident Rubyist rather than as someone who can just program in Rails.</p>

<p>What I did when I left Flatiron to prepare for job interviews mostly focused on Ruby. I worked on <a href="http://www.projecteuler.net">Project Euler</a> problems and tried building multi-class command line programs, which helped me structure my code and think from an object-oriented perspective. Tasks like trying to build a restaurant bill-splitting tool or a sports draft room via the command line can help you think about the fundamental business logic of an application and how to model your schema, rather than focusing on how the front-end looks. While building software requires an understanding of both back and front-end technologies, the core of any good engineer is being able to break down a problem into its constituent parts and to understand how those parts can be composed to build a coherent whole. These skills can be end-agnostic; the effective use of both back-end frameworks like Rails or front-end tools like Backbone.js requires an ability to structure data and process user input.</p>

<p><strong>Being a developer is pretty damn fun</strong></p>

<br>


<p>Sometimes I go to work thinking that its unfair to others that I get to do what I do. Learning to code and working as a developer has been an amazing and fun experience, and I&#8217;ve thus far thoroughly enjoyed working at the NYT. Yet at the same time, coding has a certain escapist quality to it. I can easily zone out for hours at a time, put on my music and just see where my creativity takes me. I&#8217;m a firm believer that the work we do should be service-oriented, despite being a profit-seeking enterprise. Developers have this great skill of solving modern problems, many of which can be addressed by using the powerful connective capabilities of the Internet and accessibility of distribution platforms like smartphones. Solving these problems (which are most often outside the strict domain of an engineer) requires not just technical abilities, but also an empathetic understanding of why those are problems in the first place.</p>

<p>I&#8217;ve always thought that the most fascinating problems developers are meant to solve with software are problems outside the traditional realm of software. This means that to effectively solve problems, knowing who you&#8217;re solving problems for is as important as being technically able to solve those problems. Avi talks a lot about empathy as a developer, and I think he&#8217;s really right about it. I work on a daily basis with editors who are the end users of the product I&#8217;m currently building. Empathy for the needs and interests of my clients (i.e., users) is critical to prioritizing my development tasks and knowing when to hone in on the annoying details and when to back out of a rabbit hole. While solving problems is objectively fun, it can be a fruitless exercise if those problems are not actually the problems faced by the people you&#8217;re tasked to serve in your work. Empathy, understanding, communication - these are all the soft skills that connect you back to the real world as a developer, rather than just zoning out, donning your headphones and coding away at a fantasy world problem.</p>

<p>Hope that was useful for anyone out there looking for a developer job. Best of luck!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Use Rake Tasks to Generate Raw SQL From ActiveRecord Migrations]]></title>
    <link href="http://eewang.github.com/blog/2013/07/29/how-to-use-rake-tasks-to-generate-migration-sql/"/>
    <updated>2013-07-29T19:26:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/07/29/how-to-use-rake-tasks-to-generate-migration-sql</id>
    <content type="html"><![CDATA[<p>Recently at the NYT on the product I&#8217;m working on, we came across the problem of having to convert ActiveRecord migrations into raw SQL in order to be processed on our production database. Our infrastructure/systems team needs SQL in order to generate migrations; since not all teams at the NYT use Rails, ActiveRecord&#8217;s migrations cannot be automatically applied to the production database.</p>

<!--more-->


<p>So the senior developer I work closely with wrote a rake task that parsed the SQL generated by ActiveRecord migration tasks into a .sql file, which our systems team could then use to generate the necessary database migrations. Although I had no role in actually writing the code, I thought that the rake task touched on a few interesting concepts in Ruby, so I felt compelled to post it and annotate it a little bit.</p>

<p>Here&#8217;s the code in its entirety. Its saved in a .rake file in the tasks folder in the lib directory.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">namespace</span> <span class="ss">:db</span> <span class="k">do</span>
</span><span class='line'>  <span class="o">[</span> <span class="ss">:migrate</span><span class="p">,</span> <span class="ss">:rollback</span> <span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">n</span><span class="o">|</span>
</span><span class='line'>    <span class="n">namespace</span> <span class="n">n</span> <span class="k">do</span> <span class="o">|</span><span class="n">migration_task</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">original_task</span> <span class="o">=</span> <span class="n">migration_task</span><span class="o">.</span><span class="n">instance_variable_get</span><span class="p">(</span><span class="s2">&quot;@scope&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span> <span class="s2">&quot;:&quot;</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">[</span><span class="ss">:with_sql</span><span class="p">,</span> <span class="ss">:to_sql</span> <span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">desc</span> <span class="s2">&quot;Run migration, and generated SQL&quot;</span> <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="ss">:with_sql</span>
</span><span class='line'>        <span class="n">desc</span> <span class="s2">&quot;Generate migration SQL&quot;</span> <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="ss">:to_sql</span>
</span><span class='line'>        <span class="n">task</span> <span class="n">t</span> <span class="o">=&gt;</span> <span class="ss">:environment</span> <span class="k">do</span> <span class="o">|</span><span class="n">sql_task</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">case</span> <span class="n">original_task</span>
</span><span class='line'>          <span class="k">when</span> <span class="s2">&quot;db:migrate&quot;</span>
</span><span class='line'>            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;upgrade.sql&#39;</span>
</span><span class='line'>          <span class="k">when</span> <span class="s2">&quot;db:rollback&quot;</span>
</span><span class='line'>            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;rollback.sql&#39;</span>
</span><span class='line'>          <span class="k">else</span>
</span><span class='line'>            <span class="k">raise</span> <span class="s2">&quot;unkown migration type </span><span class="si">#{</span><span class="n">original_task</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>            <span class="c1"># alias the adapter&#39;s execute for later use</span>
</span><span class='line'>            <span class="k">alias</span> <span class="ss">:old_execute</span> <span class="ss">:execute</span>
</span><span class='line'>
</span><span class='line'>            <span class="no">SQL_FILENAME</span> <span class="o">=</span> <span class="n">filename</span>
</span><span class='line'>            <span class="no">RUN_SQL</span> <span class="o">=</span> <span class="n">sql_task</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">ends_with?</span><span class="p">(</span><span class="s2">&quot;with_sql&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1"># define our own execute</span>
</span><span class='line'>            <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="nb">name</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
</span><span class='line'>              <span class="c1"># check for some DDL and DML statements</span>
</span><span class='line'>              <span class="k">if</span> <span class="sr">/^(create|alter|drop|insert|delete|update)/i</span><span class="o">.</span><span class="n">match</span> <span class="n">sql</span>
</span><span class='line'>                <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="no">SQL_FILENAME</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">sql</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">}</span>
</span><span class='line'>                <span class="n">old_execute</span> <span class="n">sql</span><span class="p">,</span> <span class="nb">name</span> <span class="k">if</span> <span class="no">RUN_SQL</span>
</span><span class='line'>              <span class="k">else</span>
</span><span class='line'>                <span class="c1"># pass everything else to the aliased execute</span>
</span><span class='line'>                <span class="n">old_execute</span> <span class="n">sql</span><span class="p">,</span> <span class="nb">name</span>
</span><span class='line'>              <span class="k">end</span>
</span><span class='line'>            <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1"># create or delete content of migration.sql</span>
</span><span class='line'>          <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="no">SQL_FILENAME</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;-- Script created @ </span><span class="si">#{</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1"># invoke the normal migration procedure now</span>
</span><span class='line'>          <span class="ss">Rake</span><span class="p">:</span><span class="ss">:Task</span><span class="o">[</span><span class="n">original_task</span><span class="o">].</span><span class="n">invoke</span>
</span><span class='line'>
</span><span class='line'>          <span class="nb">puts</span> <span class="s2">&quot;Ran </span><span class="si">#{</span><span class="n">original_task</span><span class="si">}</span><span class="s2"> and wrote sql to </span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>At a high level, this code does the following:
* Open up the db namespace and add a sub rake task atop the db:migrate and db:rollback commands
* Hijacks the execute method and writes the SQL otherwise executed by Rails to a file.
* Permit users to specify whether they want Rails to actually execute the SQL code or just to write it to a file for later use</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">namespace</span> <span class="ss">:db</span> <span class="k">do</span>
</span><span class='line'>  <span class="o">[</span> <span class="ss">:migrate</span><span class="p">,</span> <span class="ss">:rollback</span> <span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">n</span><span class="o">|</span>
</span><span class='line'>    <span class="n">namespace</span> <span class="n">n</span> <span class="k">do</span> <span class="o">|</span><span class="n">migration_task</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">original_task</span> <span class="o">=</span> <span class="n">migration_task</span><span class="o">.</span><span class="n">instance_variable_get</span><span class="p">(</span><span class="s2">&quot;@scope&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span> <span class="s2">&quot;:&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This code opens up the :db namespace and executes the same block of code for the :migrate and :rollback sub name spaces. The :with_sql and :to_sql commands get appended to both namespaces, for a total of 4 new rake commands. The last line here just reverse engineers the original command; the original_task local variable returns &#8216;db:migrate&#8217; or &#8216;db:rollback&#8217;.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="ss">:with_sql</span><span class="p">,</span> <span class="ss">:to_sql</span> <span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'><span class="n">desc</span> <span class="s2">&quot;Run migration, and generated SQL&quot;</span> <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="ss">:with_sql</span>
</span><span class='line'><span class="n">desc</span> <span class="s2">&quot;Generate migration SQL&quot;</span> <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="ss">:to_sql</span>
</span><span class='line'><span class="n">task</span> <span class="n">t</span> <span class="o">=&gt;</span> <span class="ss">:environment</span> <span class="k">do</span> <span class="o">|</span><span class="n">sql_task</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">case</span> <span class="n">original_task</span>
</span><span class='line'>  <span class="k">when</span> <span class="s2">&quot;db:migrate&quot;</span>
</span><span class='line'>    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;upgrade.sql&#39;</span>
</span><span class='line'>  <span class="k">when</span> <span class="s2">&quot;db:rollback&quot;</span>
</span><span class='line'>    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;rollback.sql&#39;</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="k">raise</span> <span class="s2">&quot;unkown migration type </span><span class="si">#{</span><span class="n">original_task</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This sets up the creation of a file based on the type of migration task that is being considered. &#8216;upgrade.sql&#8217; will execute a migration while &#8216;rollback.sql&#8217; will reverse one. The idea is that adding these .sql files will make it as easy as possible for a database architect to execute a migration on a staging or production server, rather than deciphering the Rails migration herself. I generally take for granted the fact that I work in Rails; now that I&#8217;m no longer at Flatiron, I need to remember that not all databases uses the Rails ORM to connect to an application, but SQL remains a common language that most databases understand. Although ActiveRecord seems to abstract away so much of the underlying database connections, at the end of the day all its doing is executing SQL, which you can write directly into your Ruby code. In fact, a common complaint I&#8217;ve heard about Rails is that for more complex queries, you can&#8217;t rely just on ActiveRecord to generate efficient queries and instead have to fall back on executing raw SQL.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="c1"># alias the adapter&#39;s execute for later use</span>
</span><span class='line'>  <span class="k">alias</span> <span class="ss">:old_execute</span> <span class="ss">:execute</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">SQL_FILENAME</span> <span class="o">=</span> <span class="n">filename</span>
</span><span class='line'>  <span class="no">RUN_SQL</span> <span class="o">=</span> <span class="n">sql_task</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">ends_with?</span><span class="p">(</span><span class="s2">&quot;with_sql&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># define our own execute</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="nb">name</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
</span><span class='line'>    <span class="c1"># check for some DDL and DML statements</span>
</span><span class='line'>    <span class="k">if</span> <span class="sr">/^(create|alter|drop|insert|delete|update)/i</span><span class="o">.</span><span class="n">match</span> <span class="n">sql</span>
</span><span class='line'>      <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="no">SQL_FILENAME</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">sql</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">old_execute</span> <span class="n">sql</span><span class="p">,</span> <span class="nb">name</span> <span class="k">if</span> <span class="no">RUN_SQL</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="c1"># pass everything else to the aliased execute</span>
</span><span class='line'>      <span class="n">old_execute</span> <span class="n">sql</span><span class="p">,</span> <span class="nb">name</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is the core of the rake task, and it includes some nifty metaprogramming components, including class_eval and the alias method. The code overrides ActiveRecord&#8217;s default #execute method. When the interpreter hits the class_eval method, it executes the following code as if that code was included in the class. In this case, execute is an instance method, since class_eval is a method in the Module class and so the code in the enclosed methods is executed in the context of that class (e.g., as an instance method). Confused? Don&#8217;t worry, I&#8217;m still trying to fully grasp how some of these metaprogramming methods work.</p>

<p>Anyways, the use of class_eval enables the rake task to extend the functionality of the standard #execute method and have it write out to a text file. The default method takes in raw sql as an argument and executes it on the connection&#8217;s class. By writing our own method, this allows us to insert logic before the execution occurs. The alias stores the Rails execute method as :old_execute, which is called only if the rake task includes the :with_sql suffix. If the sql that Rails would otherwise execute includes a migration task (e.g., CREATE, ALTER, DROP, INSERT, DELETE or UPDATE), then this sql is written to a file saved to the root Rails directory.</p>

<p>If you&#8217;re interested in the concepts covered in this code, here are a few links that are helpful:</p>

<p><a href="http://www.jimmycuadra.com/posts/metaprogramming-ruby-class-eval-and-instance-eval" target="_blank">Class Eval vs. Instance Eval</a></p>

<p><a href="http://paul-wong-jr.blogspot.com/2012/04/ruby-metaprogramming-with-classeval.html" target="_blank">More about class_eval</a></p>

<p><a href="http://andreacfm.com/2012/11/29/ruby-alias-vs-alias-method/" target="_blank">Ruby&#8217;s alias and alias_method</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using ActiveModel Serializers to Build Great JSON Interfaces]]></title>
    <link href="http://eewang.github.com/blog/2013/07/23/using-activemodel-serializers-to-build-great-json-interfaces/"/>
    <updated>2013-07-23T14:07:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/07/23/using-activemodel-serializers-to-build-great-json-interfaces</id>
    <content type="html"><![CDATA[<p>I&#8217;ve been at the New York Times on the New Digital Products team for a little over two weeks now. Thus far, its been an awesome experience. I&#8217;ve had the opportunity to jump right in and commit code, primarily helping build the Rails backend interface for a mobile application. I&#8217;ve been spending time trying to get up to speed on the various internal software tools that the NYT provides, and I&#8217;ve come to appreciate that from a technical perspective, the NYT is an API-driven organization.</p>

<!--more-->


<p>Most of the APIs I dealt with at Flatiron were for public consumption (e.g., Viewfinder leveraged the Instagram API pretty heavily), so its been interesting to see how the NYT develops internal APIs to decrease inter-team dependencies while reducing the potential for overlapping responsibilities. With so many teams (e.g., internal CMS, user-generated content, video, etc.) working together to build a single journalistic product, I&#8217;ve learned that necessary to have public, internal JSON interfaces for different teams to work with. As such, I&#8217;ve had the chance to use a Rails module called ActiveModel::Serializers that helps developers build a sensible JSON interface in an object-oriented manner that&#8217;s pretty intuitive.</p>

<p>ActiveModel::Serializers is a component of the Rails API that enables an object-oriented approach to serializing ActiveRecord objects. The module can also be used to provide customized JSON objects depending on the requester. Serializers know about both a model and the environment in which it is being accessed, so if an admin user accesses the API you as the developer can provide one level of access to the underlying data, while providing a less detailed view to a non-admin user. To get this functionality, you can just add the &#8216;active_model_serializers&#8217; gem to your Gemfile.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Gemfile.rb</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;active_model_serializers&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Serializers serve as a thin layer of abstraction between models and your JSON, and can be a useful tool in quickly adjusting your application&#8217;s API without making large scale changes to the underlying schema. With AM:Serializers, its easy to change JSON presentation logic without affecting underlying model logic, and enables you to quickly add or modify attributes to an object&#8217;s JSON representation that are not explicitly part of the model/table.</p>

<p>For example, say you&#8217;re responsible for building the backend for a football statistics application. The NFL wants to create a mobile app for delivering useful analytics to users and in order to do so, needs to be able to get statistics for individual players and teams. However, the data requirements can vary from week-to-week and by use case - for example, international apps built off the stats API require &#8216;receiving yards&#8217; to be in meters whereas domestic apps display such stats as yards. By adding in serializer support, you can deliver a different data structure to each client application even if the underlying data is the same. Another example might be timestamps, which are saved in the database as a Unix timestamp but may need to be delivered to client apps in a human readable form, adjusted for each user&#8217;s time zone.</p>

<p>This is admittedly a contrived example, but it gets the point across. Serializers make it easy to further separate the presentation layer of your application from the underlying model layer, even though by &#8220;presentation&#8221; I&#8217;m referring to the JSON representation of model objects rather than actual HTML files. This way, other applications can access the underlying data by virtue of a public API while you continue to tinker around with the backend. So long as your API remains consistent (or changes are properly documented), other teams or applications that depend on your API can continue developing without worrying about every change you make to the underlying code.</p>

<p>To get started, just use a Rails generator to create a serializer:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails generate serializer team
</span></code></pre></td></tr></table></div></figure>


<p>Imagine I have a Team class (i.e., model) to represent a football team. A single team has many games (16 regular season, in the case of the NFL) and many players. In the serializer, I specify which attributes I want available in the JSON object, which typically will correspond to the methods in the body of the class or the attributes of the model. If I have a custom defined attribute (e.g., an attribute that is not the same as an attribute in my model), I need to write out a method with the same signature so that Rails knows how to interpret my serialized attribute.</p>

<p>I can also specify associations and customize how those associations appear in my JSON. Each team has many players, which is a separate model that has data about a player&#8217;s height, weight, jersey number, etc. In this example, I don&#8217;t need all of that information - all I need is the player&#8217;s name, jersey number and age. So I can override the typical association dispatch call (which would embed the JSON representation of each player associated with the team under the :players key) by writing a custom method.</p>

<p>Note that you get access to an &#8216;object&#8217; variable within a given serializer, which returns the related model object (e.g., a given team in this example) and would be the same as referencing &#8216;self&#8217; within the corresponding model file.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">TeamSerializer</span> <span class="o">&lt;</span> <span class="ss">ActiveModel</span><span class="p">:</span><span class="ss">:Serializer</span>
</span><span class='line'>  <span class="n">attributes</span> <span class="ss">:team_name</span><span class="p">,</span> <span class="ss">:date_updated</span><span class="p">,</span> <span class="ss">:multimedia</span><span class="p">,</span> <span class="ss">:team_url</span><span class="p">,</span> <span class="ss">:stadium_address</span><span class="p">,</span> <span class="ss">:finances</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:players</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:games</span>
</span><span class='line'>  <span class="n">delegate</span> <span class="ss">:current_user</span><span class="p">,</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="ss">:scope</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">team_name</span>
</span><span class='line'>      <span class="s2">&quot;</span><span class="si">#{</span><span class="n">object</span><span class="o">.</span><span class="n">city</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">object</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">date_updated</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">updated_at</span><span class="o">.</span><span class="n">to_i</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">team_url</span>
</span><span class='line'>      <span class="s2">&quot;http://www.nfl.com/</span><span class="si">#{</span><span class="n">obje</span><span class="o">.</span><span class="n">ctcity</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">stadium</span>
</span><span class='line'>      <span class="n">stadium</span> <span class="o">=</span> <span class="n">object</span><span class="o">.</span><span class="n">stadium</span>
</span><span class='line'>      <span class="s2">&quot;</span><span class="si">#{</span><span class="n">stadium</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">stadium</span><span class="o">.</span><span class="n">city</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">stadium</span><span class="o">.</span><span class="n">state</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">stadium</span><span class="o">.</span><span class="n">zip</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">multimedia</span>
</span><span class='line'>      <span class="n">object</span><span class="o">.</span><span class="n">team_logo</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">players</span>
</span><span class='line'>      <span class="n">object</span><span class="o">.</span><span class="n">players</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">player</span><span class="o">|</span> <span class="o">[</span><span class="n">player</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">player</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">player</span><span class="o">.</span><span class="n">age</span><span class="o">]</span><span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">finances</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">current_user</span><span class="o">.</span><span class="n">is_admin?</span>
</span><span class='line'>        <span class="p">{</span><span class="ss">:revenue</span> <span class="o">=&gt;</span> <span class="n">object</span><span class="o">.</span><span class="n">revenue</span><span class="p">,</span> <span class="ss">:profit</span> <span class="o">=&gt;</span> <span class="n">object</span><span class="o">.</span><span class="n">profit</span><span class="p">,</span> <span class="ss">:costs</span> <span class="o">=&gt;</span> <span class="n">object</span><span class="o">.</span><span class="n">costs</span><span class="p">}</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="p">{}</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the controller, make sure that you add a respond_to block that specifies a json format.JSON responses to requests that hit the &#8216;#show&#8217; action will be translated by the TeamSerializer class and formatted accordingly.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># teams_controller.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">TeamsController</span> <span class="o">&lt;</span> <span class="ss">ActiveModel</span><span class="p">:</span><span class="ss">:Controller</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">show</span>
</span><span class='line'>    <span class="vi">@team</span> <span class="o">=</span> <span class="no">Team</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">html</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">:json</span> <span class="o">=&gt;</span> <span class="vi">@team</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice too that I use the &#8216;current_user&#8217; helper method (a method that I would typically define in my application controller to reference the currently logged in user) to restrict the access level to a team&#8217;s financial data only to team administrators. In order to have access to this method, I need to delegate the current_user method call to the scope object, which I can specify in my application controller like so:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># application_controller.rb</span>
</span><span class='line'><span class="n">serialization_scope</span> <span class="ss">:view_context</span>
</span></code></pre></td></tr></table></div></figure>


<p>Rails will automatically look for a TeamSerializer file when it publishes JSON, but if you want to specify a customized serializer, you can indicate it in your model file, like so, assuming you also change the serializer name to match:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># team.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Team</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="c1">#...</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">active_model_serializer</span>
</span><span class='line'>      <span class="no">FootballTeamSerializer</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="c1">#...</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then, specify the custom serializer within the controller action call by passing a :serializer => :custom_serializer key-value into the render call, like so:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">render</span> <span class="ss">:json</span> <span class="o">=&gt;</span> <span class="vi">@team</span><span class="p">,</span> <span class="ss">:serializer</span> <span class="o">=&gt;</span> <span class="no">FootballTeamSerializer</span>
</span></code></pre></td></tr></table></div></figure>


<p>I&#8217;ve posted a few useful links below that go over how to start using serializers in your application (surprise surprise, there&#8217;s even a RailsCast on ActiveModel::Serializers).</p>

<p>As for testing these serializers, I&#8217;ve been testing my serializer classes using model specs with Rspec. I&#8217;ve used OpenStruct to create mock objects within the spec, just to make sure that the resulting JSON is correctly formatted. I&#8217;ve also been meaning to add integration tests so that the full request-response cycle is validated, not just the JSON API endpoint.</p>

<p>If you&#8217;re looking for more information, here are some helpful links that explain further the benefit of using ActiveModel::Serializers in building well-structured JSON for your API.</p>

<p><a href="http://robots.thoughtbot.com/post/50091183897/fast-json-apis-in-rails-with-key-based-caches-and" target="_blank">Thoughtbot on Fast JSON APIs</a></p>

<p><a href="http://www.ruby-doc.org/gems/docs/a/active_model_serializers-0.6.0/ActiveModel/Serializer.html" target="_blank">Documentation on ActiveModel::Serializers</a></p>

<p><a href="http://byroot.github.io/ams-slides/#/" target="_blank">Helpful Slides</a></p>

<p><a href="http://yehudakatz.com/2010/01/10/activemodel-make-any-ruby-object-feel-like-activerecord/" target="_blank">Yehuda Katz on Serialization</a></p>

<p><a href="http://railscasts.com/episodes/409-active-model-serializers" target="_blank">Active Model Serializers Railscast</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Five Lessons Learned On The Job]]></title>
    <link href="http://eewang.github.com/blog/2013/07/14/lessons-learned-on-the-job/"/>
    <updated>2013-07-14T04:52:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/07/14/lessons-learned-on-the-job</id>
    <content type="html"><![CDATA[<p>Last week I started my job at the New York Times. And while I&#8217;ve learned a lot over my first week, I feel it necessary to write a post on what I learned working at 8to18 for four weeks. As my first actual developer gig, working at 8to18 has helped me grasp what it means to be a professional developer, and while I undoubtedly still have a lot to learn, I felt better prepared going into my job at the NYT having worked at a start-up for a short period of time. Here are a few lessons that I&#8217;ve learned now that I&#8217;ve had a chance to explore an existing code base for a non-trivial web application that has an active userbase.</p>

<!--more-->


<p><strong>1) Make git commits informative</strong></p>

<p>Git commits should communicate your intent as a developer through both the code changed within a given commit and the associated commit message. I&#8217;ll try to include active verbs in my commit messages and separate sub-units of work by semi colons (e.g., something like &#8220;adds functional tests, refactors model code&#8221;). At 8to18, Jira was the primary tool for workflow management, so every code commit reflected a specific Jira issue. Adding the Jira issue number to my commit messages and specific language preceded by a hashmark allowed for tighter integration between Github and Jira. Initially, this was difficult for me as I had admittedly been sloppy with my commits at Flatiron, where I would fix whatever I saw that was wrong rather than noting it in Trello or Github issues and reverting back to fix it later in a different git branch. Working in a professional development environment has shown me the communicative value of tight, focused git commits with informative messages.</p>

<p><strong>2) Its (almost) all about forms</strong></p>

<p>A wise teacher (i.e., Avi) once said, &#8220;90% of web development is just building forms.&#8221; I found this to be especially true in the work I did for 8to18, which consisted primarily of bug fixes and feature developement for their registration application. Used by parents and school administrators to register students for extracurriculars and sports, the registration app has easily been the most complex set of forms that I&#8217;ve worked with. And I say &#8220;set of forms&#8221; rather than just &#8220;forms&#8221;, because the app has an added twist by enabling admins to create their own forms on the fly - adding and removing form steps depending on the particular sport or activity in question. Furthermore, the app had to address idiosyncratic use cases  specific to certain schools (e.g., schools in North Carolina require prospective athletes to note their felony conviction history before registering whereas other states do not have that requirement).</p>

<p>Building this app in a modular way required the use of not just the domain models that contain the core business logic but a set of support modules to perform specific tasks like validate, present or format data. Form workflow follows a certain pattern - users input information, information is checked and validated, then that information is used elsewhere in the application. This pattern isn&#8217;t inherently difficult to implement in Rails as the framework provides a lot of helpers and guidance to get forms up and running quickly. Yet knowing which components of the workflow can be abstracted into a module or class to enable user flexibility and minimize the added work needed when requirements change (as they most certainly will), therein lies the challenge of building usable, scalable forms and seems to come with just more experience.</p>

<p><strong>3) Testing is like eating your vegetables</strong></p>

<p>Learning to write test code before implementation code has not been easy. Admittedly, I&#8217;m not quite at full test-driven development; I&#8217;m closer to test-and-implement-at-the-same-time development. Writing tests can be frustrating - I&#8217;ve spent a good chunk of time banging my head against the wall trying to write meaningful tests. And while its not always fun to write tests, you have to do it, and you generally feel better after writing meaningful, passing tests.</p>

<p>Also, I&#8217;ve learned that not all tests are made equal. I&#8217;m more willing to write unit tests rather than functional or integration tests, as my frustration level rises when I&#8217;m faced with a number of preconditions just to get certain controller actions to be triggered (e.g., before filters, login requirements, etc.). Unit tests are generally easier for me to write - the universe of dependencies is smaller and the model layer is the business logic of the application. Coming in to work on an existing application, much of the model code had already been written, so I worked a lot in the controllers - utilizing existing model methods to produce new functionality. Over the course of the 4 weeks at 8to18, however, I&#8217;ve come to appreciate the value of good tests in building a resilient application. They&#8217;ve also come in handy as documentation - when I&#8217;m not sure what a model or controller is intended to do, I&#8217;d revert to the tests to provide clues.</p>

<p><strong>4) Metaprogramming isn&#8217;t always the answer</strong></p>

<p>In my zeal to try new programming techniques that I&#8217;ve learned, I&#8217;ve tended to see metaprogramming techniques as the end goal when writing code - good practice regardless of the context. However, I&#8217;ve learned that while metaprogramming can reduce the absolute number of lines of code in your application, it can come at the expense of readibility for other developers on your team. In some instances, this is unavoidable. Whenever I&#8217;ve explored the Rails source code, for example, the sheer amount of metaprogramming makes it difficult for me to grasp what&#8217;s going on. At the same time, that code gives Rails the out-of-the-box functionality that makes it so easy to get apps up and running. I can imagine that writing that customizable functionality into Rails without using metaprogramming would be practically impossible.</p>

<p>What matters the most is balancing the readibility of normal code with the power and flexibility of metaprogramming. Like anything in the world of programming, its all about the right tool for the job. For a framework like Rails, with a core group of contributors and a wide universe of use cases, metaprogramming is essential. However, for a smaller team with new developers and a more defined set of uses cases, metaprogramming could be more detrimental than helpful.</p>

<p><strong>5) Commercial concerns trump all</strong></p>

<p>While clean, beautiful code is an ideal worth aspiring to, at the end of the day, its still subordinate to the commercial needs of the product or business. For example, usage of the registration app that I&#8217;m working tends to be lumpy and clustered in certain months of the year (e.g., August, right before the start of the school year). Spending weeks to write perfect code for a feature could actually be detrimental if that means its release is pushed beyond the period of peak usage.</p>

<p>Knowing when to focus on great code versus just get something working and out the door is something I think Flatiron positioned me well to understand. Coming from a non-traditional coding background (i.e., didn&#8217;t take a computer science class in college), I feel like I have a good sense of commerciality when it comes to building products for actual customers. Working at 8to18 just reinforced my understanding of code as a tool to solve real world problems; when writing beautiful code rather than finding a solution to the problem at hand becomes the end goal, that&#8217;s when you need to recalibrate.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Developing Web Applications with 8to18 Media]]></title>
    <link href="http://eewang.github.com/blog/2013/06/11/developing-web-applications-with-8to18-media/"/>
    <updated>2013-06-11T20:49:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/06/11/developing-web-applications-with-8to18-media</id>
    <content type="html"><![CDATA[<p>I&#8217;ll admit it - I&#8217;ve been slacking the past few weeks about blogging. Most of what I&#8217;ve been doing since mid-May since my job search concluded has been enjoying NYC, hanging out with friends and doing a some Javascript learning. Its tough to keep up the pace of Flatiron after the end of the program. While I&#8217;ve still be trying to code every day and spend quality time learning Javascript and Backbone, I&#8217;ve taken time to relax and enjoy myself since I&#8217;ll have many more years of working ahead of me and increasingly less time to just live and enjoy the city.</p>

<!--more-->


<p>However, also like Flatiron, all good things must come to an end, so since Monday, I&#8217;ve been working at a startup called 8to18 Media in Lombard, IL (~30 mins west of Chicago) as a contract developer. My brother works as the co-head of engineering at 8to18, which builds web applications for high school activities (e.g., sports, clubs, summer camps, etc.), and they agreed to bring me on for a month before I start at the NYT to work on their backlog of bug fixes and feature requests. For me, I&#8217;m excited for the opportunity to get back into the habit of daily coding and to learn more about how to be a professional developer. While the 6 or so free weeks post-Flatiron were great (well, at least the 3 or so since wrapping up the job search process), I&#8217;ll admit that I was getting a bit antsy and was itching to get back into coding and learning every day. I hope that this experience will give me momentum leading up to my NYT job this July.</p>

<p>For example, in just the first few days on the job, its been great to learn more about the project management aspects of being a developer. I&#8217;m working on 8to18&#8217;s registration application, which is a Rails app that parents and schools use to register children in activities. The app is under active development and usage, so its been great to see how customer feedback directly affects development. 8to18 uses a project management tool called Jira, which is similar at a high level to Trello (used by the Handrai.se team at Flatiron) but much more robust and full featured. Jira syncs with Github and commits are pulled into a dashboard newsfeed that shows what everyone on the team is working on. It also provides cool analytics on which tickets have been assigned, what their status is and what else is scheduled in the queue.</p>

<p>Compared to the group work at Flatiron, the git process here is more rigorous. I&#8217;ve learned how to keep my commits focused on a single issue; rather than cleaning up every unrelated error I see when going into the code to fix a bug, I&#8217;m trying to get into the habit of creating Jira tickets. This makes the bug fix commit as limited as possible, which minimizes the risk of introducing more bugs. Each commit message is prefixed with a Jira ticket number (e.g., REG-100 for the 100th ticket under the &#8220;Registration&#8221; project) and a hashtag that can then be read by the Jira system and allocated accordingly. For example, a #resolve hashtag appended to a commit message will automatically resolve the issue in Jira when the commit is pushed to Github. At Flatiron, our commits (at least mine) may not have had the most informative messages, which made them more difficult to tie to a specific issue, bug or feature. Also, we tended to make batch commits that included a lot of unrelated code changes in one commit. At 8to18, I&#8217;m trying to get into the habit of having smaller, more focused commits that are easier to audit and test.</p>

<p>Speaking of testing, another habit that I&#8217;m learning is being more vigorous about writing tests. 8to18 emphasizes test-driven development, so I&#8217;m learning a ton about how to think about the implementation code I&#8217;m writing through the lens of Rspec tests. Yesterday, I wrote about 5 lines of code in a Rails controller that I had to support with approximately 20 lines of test code to confirm expected behavior in edge case situations. While it took me more time to wrap up the bug fix, I came out more confident in my code because I had tests to support the functionality.</p>

<p>My contract work at 8to18 will end around July 4 for a total of four weeks, after which I&#8217;ll start my job at the NYT. I&#8217;m happy to have the opportunity to code in a professional work environment and learn more about developer best practices at 8to18 before starting my full time job later this summer.</p>

<p>&#8211;
<em>Correction: 8to18 uses the default Rails testing framework (TestCase) rather than Rspec</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How I'm Learning Javascript]]></title>
    <link href="http://eewang.github.com/blog/2013/05/24/how-im-learning-javascript/"/>
    <updated>2013-05-24T07:45:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/05/24/how-im-learning-javascript</id>
    <content type="html"><![CDATA[<p>For my job at the NYT that I&#8217;ll be starting in July, I&#8217;ll likely be working a lot in Ruby and Javascript. At the Flatiron School, the focus was on becoming a back-end Ruby developer, and while we learned our fair share of JavaScript and jQuery, it was always in the context of a Ruby or Rails application. Most of the front-end focus gravitated toward DOM manipulation and traversal using jQuery and less on the functionality of Javascript as a programming language (e.g., objects, closures, inheritance / composition, etc.).</p>

<!--more-->


<p>Given that I expect that Javascript will be a substantial component of my role at the NYT, I&#8217;m planning to spend much of the next 5 weeks or so until I start refining and building my Javascript skillset. I&#8217;ve been cruising the Web accumulating JS learning resources, and I think I put together a solid syllabus.</p>

<p>I&#8217;m thinking of learning Javascript from three perspectives. First, Javascript is a full-fledged programming language and it should be learned as such. This means exploring data structures, iteration, objects, etc. in Javascript much the same way we did for Ruby. Second, Javascript is the language of the Web browser, which means learning DOM manipulation and front-end user interaction. Finally, Javascript has seen an explosion of front-end MVC frameworks in the past few years, the most well-known of which include <a href="http://backbonejs.org/" target="_blank">Backbone.js</a>, <a href="http://emberjs.com/" target="_blank">Ember.js</a> and <a href="http://angularjs.org/" target="_blank">Angular.js</a>. These frameworks help you structure and organize your Javascript, and generally improve the user&#8217;s experience as they can decrease the server communication overhead involved in any modern, database-driven application.</p>

<p>Here are a few of the ways I&#8217;m planning to practice writing and understanding Javascript over the next few weeks:</p>

<p><strong>Build Ruby Methods</strong></p>

<p>One of the benefits of coding in Ruby is that it provides a lot of the Enumerable methods like #collect and #inject that abstract away the need to write a basic iterator like a for loop. While these abstract methods provide a considerable amount of functionality in a terse, human-readable syntax, its easy to take them for granted. Thus, I&#8217;m planning to practice Javascript by writing the JS equivalent of the Ruby methods I use most frequently but do not have parallels in core JS (not considering jQuery or other libraries). Hopefully, this will force me to dive deep into both the Ruby and Javascript documentation and build up my Javascript muscle memory.</p>

<p><strong>Solve Project Euler</strong></p>

<p>Completing <a href="http://projecteuler.net" target="_blank">Project Euler</a> problems using Ruby has been a great way for me to strengthen not only my Ruby scripting skills but also my software design understanding, as I always try to properly encapsulate my Project Euler solutions and make the solution object-oriented. I plan to use the same approach to learning Javascript. First, I&#8217;ll translate the Project Euler problems that I&#8217;ve already solved from Ruby into Javascript, if only as a way to get in the habit of building JS objects using the constructor and prototype patterns. Then, I&#8217;ll work on new Project Euler problems and do the reverse translation - Javascript to Ruby. This way, I&#8217;ll become better at moving seamlessly between JS and Ruby, which will undoubtedly help me in my role at the intersection of the front-end and back-end.</p>

<p><strong>Read Books</strong></p>

<p>I&#8217;ve solicited advice from a number of developers on what are the best Javascript books to read, and here&#8217;s the list that I&#8217;m planning to go through to learn JS:</p>

<ul>
<li>&#8220;Professional Javascript for Web Developers&#8221; by Nicholas Zakas</li>
<li>&#8220;Developing Backbone.js Applications&#8221; by Addy Osmani</li>
<li>&#8220;Javascript Patterns&#8221; by Stoyan Stefanov</li>
<li>&#8220;Object Oriented Javascript&#8221; by Stoyan Stefanov</li>
</ul>


<p>These four books seem to be relatively accessible to developers first exploring Javascript, yet also are challenging enough to keep me engaged and constantly learning. I think these books focus more on software design and code patterns in Javascript, which I like, rather than just DOM manipulation. I learn best by understanding the core of a language so that I can use libraries like jQuery knowing full well how its implemented under the hood. Much like how the Flatiron School teaches Rails only after teaching Ruby, SQL, ORMs, etc., I&#8217;d like to be proficient in core Javascript as a prerequisite to becoming an expert in libraries/frameworks like jQuery or Backbone.</p>

<p><strong>Complete Online Tutorials (Codecademy, Code School)</strong></p>

<p>When I first started to learn how to code, I learned primarily through in Codecademy and Code School tutorials. Those were helpful in providing a general overview to Javascript, but with a lot of hand-holding. Also, neither Codecademy and Code School have perfect interpreters, so there are times when you write perfectly valid code, but you can&#8217;t pass the challenge because of some quirk or bug in the in-browser interpreter. This led to much frustration when I was first learning how to code, and the content I learned via Codecademy, while useful, felt somewhat disjointed as I was chained to working in the browser interpreter they provided.</p>

<p>Now that I know how to code though, going back through Codecademy and Codeschool has been a great way to solidify core concepts. I still feel like they hold your hand too much when completing code challenges, but I can get more out of the tutorials now that I have a stronger foundation in code. Codecademy has a pretty solid Javascript course, and Code School offers tutorials in Backbone and jQuery that I&#8217;ve found useful.</p>

<p><strong>Work on a Project</strong></p>

<p>This is a bit of no-brainer as a learning technique. Completing a project will help me most with learning front-end frameworks. I am familiar with Angular, having used that in project, but I&#8217;m planning to turn my focus to Backbone, given that the NYT uses Backbone pretty heavily for its front-end code (perhaps because Jeremy Ashkenas, the creator of Backbone, used to be a developer on the NYT&#8217;s Interactive News team). I&#8217;m still tossing around a few ideas of what I could build, but this Backbone tutorial for an <a href="http://coenraets.org/blog/2011/12/backbone-js-wine-cellar-tutorial-part-1-getting-started/" target="_blank">interactive wine cellar</a> seems like a good project that I could translate to another domain.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Landing the Dream Job]]></title>
    <link href="http://eewang.github.com/blog/2013/05/18/landing-the-dream-job/"/>
    <updated>2013-05-18T23:40:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/05/18/landing-the-dream-job</id>
    <content type="html"><![CDATA[<p>I&#8217;m happy to announce that I will be joining the New York Times as a software developer this July. I&#8217;ll be working on the new Emerging Technologies team, which is a team tasked with building a new suite of web and mobile technologies for consuming NYT content. The small group consists of developers, designers, product folks and journalists/editors. I&#8217;m extremely excited to join the world&#8217;s newspaper of record and a talented developer team that will define the future of such a storied institution. I feel humbled and honored for the opportunity, and I&#8217;m eager to explore the opportunities to grow at an organization like the NYT.</p>

<!--more-->


<p>Throughout the last three weeks, I&#8217;ve had the opportunity to speak with a variety of start-ups and technology firms. While there are a ton of great start-ups out there doing amazing work, I couldn&#8217;t have asked for a better opportunity to learn more about the craft of code and work at the epicenter of a rapidly-changing journalism industry that continues to grapple with the effects of technology on its business and product model. I&#8217;ve been blessed to find a position that can combine my professional experience serving as an editor at the <a href="http://dukechronicle.com" target="_blank">Duke Chronicle</a> and working on investment products at <a href="http://www.blackstone.com/our-businesses/aam/hedge-fund-solutions-(baam)" target="_blank">Blackstone</a>. I&#8217;ll likely be coding mostly in Ruby and Javascript, and will have the chance to learn other languages and technologies, like Objective-C. I&#8217;m incredibly thankful to Avi &amp; Co. and my classmates at <a href="http://flatironschool.com/" target="_blank">the Flatiron School</a> for not only teaching me how to code, but showing me how code can be equal parts analytical and creative.</p>

<p>The job will undoubtedly be challenging, having to build products for a newspaper that gets <a href="http://en.wikipedia.org/wiki/The_New_York_Times#Online_activity" target="_blank">30 million unique visitors per month</a>, but I&#8217;m eager for the challenge and excited for the growth potential at the NYT!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Metaprogramming Ruby and Rails Antipatterns (Part 2 of 2)]]></title>
    <link href="http://eewang.github.com/blog/2013/05/17/metaprogramming-ruby-and-rails-antipatterns-part-2-of-2/"/>
    <updated>2013-05-17T08:45:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/05/17/metaprogramming-ruby-and-rails-antipatterns-part-2-of-2</id>
    <content type="html"><![CDATA[<p>I wrapped up Rails Antipatterns about a week ago shortly after reading Metaprogramming Ruby. Reading both books side-by-side has helped me better understand the relationship between Ruby and Rails and how Ruby&#8217;s metaprogramming capabilities provide the &#8220;magic&#8221; that Rails is often associated with. Rails Antipatterns is a great book that uses commonly abused patterns in Rails to illustrate refactoring opportunities. I was able to complete the book a few weeks back, but I&#8217;ve been keeping busy with the interview process (more on that in another post) and side projects such that I haven&#8217;t been able to blog as much as I would have wanted. That&#8217;s been one of the hardest parts of the interview process in that I just have less time to actually code, blog and read. Anyways, I figured that I&#8217;d write down some of my thoughts on Rails Antipatterns alongside Metaprogramming Ruby and the areas where Antipatterns helped me the most in structuring my Rails code.</p>

<!--more-->


<p>I recommend Rails Antipatterns as a great way to improve your &#8220;code smell.&#8221; It provides practical advice to how to structure your code and general best practices when developing a Rails application. Compared to Metaprogramming Ruby, you won&#8217;t get the same depth into Ruby&#8217;s object model and method dispatch process in Rails Antipatterns, but then again, that&#8217;s not the purpose of the book. Rails Antipatterns will tell you that you should use &#8220;delegate_to&#8221; as a way to reduce method chaining for your domain objects, whereas Metaprogramming Ruby will explain the fundamentals of how &#8220;delegate_to&#8221; actually works and less about the day-to-day use cases for the macro. One of my favorite parts of Metaprogramming Ruby is that it goes in depth in the second half of the book into how ActiveRecord creates its so-called &#8220;magical&#8221; finder methods dynamically using #method_missing. Conversely, Rails Antipatterns provides practical advice on when to use those macros and helper methods that Rails provides. Antipatterns explains what&#8217;s in the Rails toolkit and how to use it, while Metaprogramming explains how the toolkit works.</p>

<p>I thought Antipatterns was overall a useful book, but at times I found it a bit disjointed. More like a compilation of various how-to guides rather than a coherent instruction flow. Whereas Metaprogramming has the core theme of the Ruby object model, Antipatterns is less grounded on an overriding programming construct and is driven more by observation of bad habits by the average Rails programmer (hence the title). Its still a useful book, but one that I think can be valuable even if you just skim to the sections that you struggle with the most and read the book in bits and parts. Here were a few of the sections that I found most useful to remind myself of a few overarching principles in application development - keep code DRY (don&#8217;t repeat yourself), minimize and manage dependencies and properly encapsulate logic.</p>

<p><strong>Use view helpers</strong></p>

<p>When I first started building applications with Rails, I tended to put logic in the first place where I could fit it in. Unfortunately, this often meant in my application views. Over time, my views would look like convoluted piles of mixed in HTML and ERb code with loops and conditionals alongside div tags and class attribute declarations. Antipatterns explains that one way to avoid this tendency is to move presentation logic into view helpers. Rails provides all sorts of helpful methods to mimic HTML markup in view helpers. For example, #content_tag is an instance method created by Rails that can be used to define a block of markup. The first argument is the HTML tag as a symbol, followed by any number of attributes structured as a hash that you want to appear in the markup (e.g., :class => &#8220;new_project&#8221;), followed by a block, like so:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">rss_link</span><span class="p">(</span><span class="n">project</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
</span><span class='line'>  <span class="n">content_tag</span> <span class="ss">:div</span><span class="p">,</span> <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s2">&quot;feed&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">link_to</span> <span class="s2">&quot;Subscribe to these </span><span class="si">#{</span><span class="n">project</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">project</span><span class="si">}</span><span class="s2"> alerts.&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="n">alerts_rss_url</span><span class="p">(</span><span class="n">project</span><span class="p">),</span>
</span><span class='line'>            <span class="ss">:class</span> <span class="o">=&gt;</span> <span class="s2">&quot;feed_link&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This code does the same as the below HTML, but instead extracts the logic into a Ruby method that can then be applied elsewhere in your views. This makes the code easier to maintain by centralizing any updates into one file rather than having to wade through multiple ERb files to pick out the same block of code to fix.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;feed&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="err">&lt;</span>% if @project %&gt;
</span><span class='line'>    <span class="err">&lt;</span>%= link_to &quot;Subscribe to #{@project.name} alerts.&quot;, project_alerts_url(@project, :format =&gt; :rss), :class =&gt; &quot;feed_link&quot; %&gt;
</span><span class='line'>  <span class="err">&lt;</span>% else %&gt;
</span><span class='line'>    <span class="err">&lt;</span>%= link_to &quot;Subscribe to these alerts.&quot;,
</span><span class='line'>    alerts_url(format =&gt; :rss), :class =&gt; &quot;feed_link&quot; %&gt;
</span><span class='line'>  <span class="err">&lt;</span>% end %&gt;
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>In fact, the #rss_link helper method can be abstracted even more by replacing the #link_to macro with another #content_tag macro. #content_tag (documentation <a href="http://apidock.com/rails/ActionView/Helpers/TagHelper/content_tag" target="_blank">here</a>)is an abstracted method that can be used to define other view methods like link_to or image_tag. All you have to do is define the HTML tag in the first argument, the content in the second argument, then pass in all the other arguments as a hash after that. Its useful in structuring HTML in a friendly Ruby syntax, and can be especially helpful in creating view helpers that provide semantic method names to blocks of logic.</p>

<p>This last point is why I like using view helpers so much. The larger an application becomes, the more difficult it is to look at code in views and understand what&#8217;s going on. For example, there may a block of ERb code that loops over a collection of objects and conditionally inserts a div element if a certain condition is met. Overtime, relying on this block of code can get cumbersome, especially as more conditionals are added, which further decreases the readability of code. View helpers provide a name to a block of logic so that people reading your code have insight into what that code is meant to do. They properly encapsulate logic and provide semantic meaning to what is at first glance just a bundle of HTML tags and Ruby code.</p>

<p><strong>Organize finder methods into scopes</strong></p>

<p>When I was building my TicketTracker side project during the first half of the Flatiron School, I quickly realized that I needed to have an easy way to query my database and organize / filter the results. ActiveRecord provides a helpful #scope class macro that can be used to chain together database query logic that you find yourself using regularly. For example, if you find yourself always retrieving objects from the database that are less than 5 days old, its easy in Rails to define a scope called &#8220;recent&#8221; that you can then apply as a class method to your model (e.g., Model.recent) rather than using (Model.where(:timestamp &lt; Time.now - 5.days) ). There&#8217;s a good deal of documentation on scopes in Rails, but at its core, scopes are just class methods. Here is a <a href="http://blog.plataformatec.com.br/2013/02/active-record-scopes-vs-class-methods/" target="_blank">great blog post from Platformatec</a> about using scopes and class methods to organize your database queries.</p>

<p><strong>Apply callback macros</strong></p>

<p>Rails has a slew of useful class macros that are executed during the ActiveRecord saving process. Similar to how Ruby has a few built in methods that are automatically triggered when a module is included (#self.included) or a method is added (#method_added), methods which conveniently allow for some pretty cool metaprogramming techniques, Rails also has methods that it looks out for when saving to the database. These callback macros include #before_validation, #after_validation, #before_save and #after_save. You can find a full listing of them <a href="http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html" target="_blank">here</a>.</p>

<p>For example, when building ViewFinder, we wanted to add the address of a  geotagged photo to the database immediately after the photo was saved. This way, we could always query the database by address as well as by coordinates rather than calculating the address at runtime. This was the result of decision that we had to make - do we save the address data to the database or calculate it whenever we need to use it? From a performance perspective, we figured that given that we were planning to make regular use of the address data (e.g., when displaying the actual location of a guessed photo), it would be more optimal to just retrieve static data from the database rather than using Geocoder each time to determine the address from the coordinates (which itself would make a Google Maps API call, so it would be slower than a database call).</p>

<p>Here is what the method looks like to convert coordinates to address. This was part of the Locatable (Locateable?) module that was mixed into the photo and guess models to enable point mapping.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">module</span> <span class="nn">Locatable</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">generate_street_address</span>
</span><span class='line'>    <span class="k">unless</span> <span class="n">latitude</span><span class="o">.</span><span class="n">nil?</span> <span class="o">||</span> <span class="n">longitude</span><span class="o">.</span><span class="n">nil?</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="no">Geocoder</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">latitude</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">longitude</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">address</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">save</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>By using a callback macro, we could ensure that Rails would execute the #generate_street_address method whenever a new photo was deemed valid to our database by including the following into any model that included Locatable instance methods:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Photo</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="n">after_validation</span> <span class="ss">:generate_street_address</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Callback macros are useful for cleaning and validating data and ensuring that objects are saved to the database are properly vetted. If you&#8217;re saving the results of an API call as we were doing for ViewFinder, these callback macros can programmatically insert your application logic into the chain of events in converting the raw JSON result of an API call to application data.</p>

<p>Overall, Antipatterns provides useful nuggets of advice when creating Rails applications. That said, its important to know what to expect when reading the book - you won&#8217;t get much in terms of explaining the inner workings of Rails or how Ruby code can generate all those dynamic finder and callback methods. Best go to Metaprogramming Ruby for a full walk-through of the Ruby object model. But, if you&#8217;re looking for immediate, practical advice on how to leave behind bad habits, Antipatterns is a useful guide. When I started reading Antipatterns, I would only have to read a few pages before I could apply what I was reading to an application I was building. Think of it as a what-not-to-do guide to Rails and you&#8217;ll be able to apply its instructions to an application right away.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Metaprogramming Ruby and Rails Antipatterns (Part 1 of 2)]]></title>
    <link href="http://eewang.github.com/blog/2013/04/29/metaprogramming-ruby-and-antipatterns-in-rails/"/>
    <updated>2013-04-29T15:03:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/04/29/metaprogramming-ruby-and-antipatterns-in-rails</id>
    <content type="html"><![CDATA[<p>I recently finished reading two programming books in parallel - Metaprogramming Ruby and Rails Antipatterns. As Ruby/Rails books go, the two could not be further apart. Metaprogramming Ruby focuses on explaining the Ruby object model and how core Ruby is constructed in order to enable you as a Ruby programmer to unlock functionality that isn&#8217;t immediately obvious. Conversely, Rails Antipatterns is more about focusing on the bad coding habits most new Rails developers experience and simple, tangible ways to avoid those  pitfalls. One book explains core Ruby (although also touches some on Rails), while the other applies specifically to Rails. One book goes as deep as possible into Ruby&#8217;s construction as a language, while the other aims to hit developers in their day-to-day programming habits. Arguably, Rails Antipatterns is more &#8220;practical&#8221; and Metaprogramming Ruby is more &#8220;theoretical,&#8221; as its generally easier to find more daily code applications of Rails Antipatterns than Metaprogramming Ruby. This post will focus on Metaprogramming Ruby and the next will focus on Rails Antipatterns.</p>

<!--more-->


<p>Reading the two books in tandem, however, has forced me to move quickly between Rails and Ruby. Its oftentimes easy to forget that Rails is just a Ruby library at its core and is constructed using many of the metaprogramming techniques described in Metaprogramming Ruby. While the two books are pretty different in their construction, they&#8217;ve helped me better understand how programming works generally along all levels of abstraction - from the Ruby core object model to the abstract class macros provided in Rails. In many ways, Metaprogramming Ruby picks up where Rails Antipatterns ends up. Reading the latter might inspire you to begin using the <a href="http://apidock.com/rails/Module/delegate" target="_blank">&#8220;delegate &#8230; to&#8221;</a> pattern in your Rails applications as a way to avoid long method chains, but Antipatterns won&#8217;t go into the nitty gritty of how Rails implements that class macro. Metaprogramming, however, will go pretty deep into how a macro like &#8220;delegate &#8230; to&#8221; is implemented and how it uses dynamic method definition to create methods in the class in which the &#8220;delegate&#8221; method is called.</p>

<p>Metaprogramming is a great way to act on the mantra that good developers take complexity and deliver simplicity. A simple definition for metaprogramming is code that writes code. An application that actively uses metaprogramming seems simple on the outside (like magic!) but is quite complex on the inside. Arguably the best example for this in the Ruby community is the eponymous Ruby on Rails. Rails presents simplicity to users; for example, whenever you create model and corresponding table and call a finder method (e.g., #find_by_name()), these finder methods are generated dynamically by Rails. The internal source code for these finder methods use liberal doses of metaprogramming and thus are tough to decipher, but the benefit of designing the application in that way means that users can build quickly using a huge library of &#8220;free&#8221; methods provided by Rails (specifically ActiveRecord in this example) without thinking too much about the method implementation.</p>

<p>I would definitely recommend reading Metaprogramming Ruby if you feel like you have a decent grasp of the language and would like to accelerate your learning. If you feel like you don&#8217;t fully understand the concepts the first time you read it, don&#8217;t worry, just read it again. Then read it a third time. Metaprogramming Ruby is one of those books that you could read it multiple times and keep learning new things from it each time, since the material is dense and the opportunities to apply the concepts are not always obvious in every Ruby script or application. Here&#8217;s a quote from the book that I think explains the value of metaprogramming and tradeoffs to consider when applying the technique.</p>

<blockquote>
If you use it sparingly, metaprogramming can make your code more readable for humans—but it will probably make it less readable for programs such as refactoring engines or code analysis tools. Ruby’s extremely dynamic nature makes life very hard for such tools, and that’s why some IDE features that work great for static languages (such as finding all the calls to a method, renaming a variable, or jumping from a method usage to its definition) are difficult to implement well in Ruby. Add metaprogramming to the mix, and your poor IDE will be even more confused. That’s one of the fundamental trade-offs of metaprogramming (and, to a point, of dynamic languages). You have the freedom to write expressive, terse code, but to read that code, you need a human brain.
</blockquote>


<p>I try to explain some of the topics included in Metaprogramming Ruby below, but its difficult to take each of these independent of the other. The most valuable part of the book for me was the in-depth explanation of the overall structure of the Ruby language and how objects and methods work. I&#8217;m someone who likes to have an understanding of the broad, high-level context in which I work, and Metaprogramming Ruby provides that context so that whenever I&#8217;m looking at a piece of code, I feel like I have a better understanding now of what&#8217;s going on (e.g., What variables are in scope? What is &#8216;self&#8217;? What methods can be accessed?).</p>

<p><strong>Procs vs. Lambdas</strong></p>

<p>At a high level, procs and lambdas define blocks of code that can be executed when called. They are somewhat analogous to anonymous functions in Javascript. Procs and lambdas are generally used for the same purpose, but they have subtle differences between them:</p>

<p>1) Procs are more flexible when evaluating arguments vs. lambdas. For example, if you define 2 arguments for a proc and only call the proc with 1, the other will be considered nil, whereas for a lambda, the call will return an ArgumentError</p>

<p>2) The return value for a proc comes from the scope in which the proc itself was defined, whereas the return value for a lambda comes from the lambda block.</p>

<p>Lambdas tend to be the first choice for Rubyists because they&#8217;re more similar to methods in that they are strict about the number of methods they accept (the &#8216;arity&#8217; of a method) and exit when return is called. Both lambdas and Procs are part of the Proc class.</p>

<p><strong>Dynamic Methods</strong></p>

<p>Dynamic methods are a set of methods that can create or call methods when the actual name of the method is not known. I&#8217;ve listed out a few of the methods used to either create or call methods dynamically and apply them to the following example:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Dog</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">toy</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@name</span> <span class="o">=</span> <span class="nb">name</span>
</span><span class='line'>    <span class="vi">@favorite_toy</span> <span class="o">=</span> <span class="n">toy</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">colors</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span class='line'>    <span class="n">args</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">arg</span><span class="o">|</span>
</span><span class='line'>      <span class="n">define_method</span> <span class="n">arg</span> <span class="k">do</span>
</span><span class='line'>        <span class="s2">&quot;I am </span><span class="si">#{</span><span class="n">arg</span><span class="o">.</span><span class="n">to_s</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">method_missing</span><span class="p">(</span><span class="n">method_call</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Sorry, we don&#39;t recognize the color </span><span class="si">#{</span><span class="n">method_call</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">colors</span><span class="p">(</span><span class="ss">:green</span><span class="p">,</span> <span class="ss">:blue</span><span class="p">,</span> <span class="ss">:red</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">private_method</span>
</span><span class='line'>    <span class="s2">&quot;You shouldn&#39;t be able to see me!&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">fido</span> <span class="o">=</span> <span class="no">Dog</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Fido&quot;</span><span class="p">,</span> <span class="s2">&quot;Ball&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>#send</em><br></p>

<p>The #send method is useful for whenever you want to call a method dynamically and are not sure of the method name at runtime. In the example above, a user can input a color among the three available options, and the #send method will figure out which method to call in the Dog class. Another use case for #send is to call private methods:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">puts</span> <span class="s2">&quot;What color do you want your dog?&quot;</span>
</span><span class='line'><span class="n">color</span> <span class="o">=</span> <span class="nb">gets</span><span class="o">.</span><span class="n">chomp</span> <span class="c1"># =&gt; blue</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">fido</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="c1"># =&gt; I am blue</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">puts</span> <span class="n">fido</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;private_method&quot;</span><span class="p">)</span> <span class="c1"># =&gt; &quot;You shouldn&#39;t be able to see me!&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>#define_method and #define_singleton_method</em><br></p>

<p>These two methods are used to define instance methods and class methods, respectively. They are methods that, when executed, create other methods that can then be called on either an instance or class object. In the code above, I call a class method called &#8220;colors&#8221; at runtime. This class method takes in an arbitrary number of arguments (in this instance, 3 colors) and creates a method for each argument. The methods that get created then return the name of the method. Admittedly, this example is a bit contrived as the same behavior could be achieved by just passing a color argument into a method that returns the value of the color. However, using #define_method and #define_singleton_method can help keep code DRY if you find a certain pattern used repeatedly in a number of different methods in your code. For me, I&#8217;ve used #define_method and #define_singleton_method whenever I notice that I&#8217;m repeating code in methods where the only difference is a reference to another object or column.</p>

<p><em>#method_missing</em><br></p>

<p>&#8220;#method_missing&#8221; acts as a catch-all method for intercepting method calls that an object doesn&#8217;t know how to interpret. If a method is called on an object that doesn&#8217;t know how to respond to the method after Ruby goes through the method lookup chain (i.e., first going into the immediate class, then upward into modules, parent classes, etc.), Ruby will call the #method_missing method that&#8217;s part of the Kernal module and mixed into every Ruby object. By creating a #method_missing method, you can hijack Ruby&#8217;s call stack and redefine what gets executed or returned whenever an unknown method is called on an object.</p>

<p>In my example, I used #method_missing to serve as a catch-all for any colors that are not recognized by the Dog class. However, #method_missing can be used to define attributes dynamically:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Dog</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span>
</span><span class='line'>    <span class="vi">@attributes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">method_missing</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span class='line'>    <span class="n">attribute</span> <span class="o">=</span> <span class="nb">name</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">attribute</span> <span class="o">=~</span> <span class="sr">/=$/</span>
</span><span class='line'>      <span class="vi">@attributes</span><span class="o">[</span><span class="n">attribute</span><span class="o">.</span><span class="n">chop</span><span class="o">]</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="vi">@attributes</span><span class="o">[</span><span class="n">attribute</span><span class="o">]</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This allows me to create any attribute of a dog that I want on the fly and #method_missing will create both a setter and getter for the method. This is possible because in the below example, &#8220;fido.legs = 4&#8221; is equivalent to fido.legs=(4), where &#8220;legs=&#8221; is the name of the method called on &#8220;fido&#8221; and &#8220;4&#8221; is the sole argument. When this method is first called, the Dog class doesn&#8217;t know how to respond to the method since there is no method called &#8220;legs&#8221;. Thus, the method call is directed to #missing_method, which then sets the attribute to the name of the method and sets the value to the first argument that is passed in.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">fido</span> <span class="o">=</span> <span class="no">Dog</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Fido&quot;</span><span class="p">,</span> <span class="s2">&quot;Ball&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">fido</span><span class="o">.</span><span class="n">legs</span> <span class="o">=</span> <span class="mi">4</span>
</span><span class='line'><span class="n">fido</span><span class="o">.</span><span class="n">legs</span> <span class="c1"># =&gt; 4</span>
</span><span class='line'>
</span><span class='line'><span class="n">fido</span><span class="o">.</span><span class="n">bark</span> <span class="o">=</span> <span class="s2">&quot;BARK BARK&quot;</span>
</span><span class='line'><span class="n">fido</span><span class="o">.</span><span class="n">bark</span> <span class="c1"># =&gt; &quot;BARK BARK&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Binding Module</strong></p>

<p>One of my favorite gems in the Ruby universe is the <a href="https://github.com/pry/pry" target="_blank">Pry</a> gem. Pry is a debugging tool that allows you to enter into the local universe when code is run. Including &#8220;binding.pry&#8221; in a set of code will pry open the code at runtime and enable you to poke around and see how certain variables are defined or used. Its probably the gem I use the most - whenever I&#8217;m writing code, be it a full-blown Rails app or a simple Ruby script, Pry tends to be the first gem I include.</p>

<p>But even though I use the gem quite often, I didn&#8217;t exactly realize how it worked. Metaprogramming Ruby explains that &#8220;binding&#8221; is actually a method in Ruby that converts a scope into an object that can then be called at a later moment. This can be an incredible tool, as the use of the &#8220;binding&#8221; method in a block of code makes that scope portable for future use, even to the point where &#8220;self&#8221; can change based on the binding context.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Dog</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">toy</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@name</span> <span class="o">=</span> <span class="nb">name</span>
</span><span class='line'>    <span class="vi">@favorite_toy</span> <span class="o">=</span> <span class="n">toy</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">get_binding</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">binding</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">fido</span> <span class="o">=</span> <span class="no">Dog</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Fido&quot;</span><span class="p">,</span> <span class="s2">&quot;Ball&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">fido_scope</span> <span class="o">=</span> <span class="n">fido</span><span class="o">.</span><span class="n">get_binding</span>
</span><span class='line'><span class="n">snuffles</span> <span class="o">=</span> <span class="no">Dog</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Snuffles&quot;</span><span class="p">,</span> <span class="s2">&quot;Stick&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">snuffles_scope</span> <span class="o">=</span> <span class="n">snuffles</span><span class="o">.</span><span class="n">get_binding</span>
</span><span class='line'>
</span><span class='line'><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;puts @name; puts @favorite_toy&quot;</span><span class="p">,</span> <span class="n">fido_scope</span><span class="p">)</span> <span class="c1"># =&gt; Fido Ball</span>
</span><span class='line'><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;puts @name; puts @favorite_toy&quot;</span><span class="p">,</span> <span class="n">snuffles_scope</span><span class="p">)</span> <span class="c1"># =&gt; Snuffles Stick</span>
</span></code></pre></td></tr></table></div></figure>


<p>Using the &#8220;binding&#8221; is helpful for accessing a scope in an object-oriented manner. The binding method is defined within the Kernal module, which is mixed into Ruby&#8217;s Object class, from which all objects inherit. This is why you can use the binding method in any class, since all classes inherit the Kernal module functionality. Pry essentially adds functionality to the binding method and literally prys open the scope and creates an IRB-like environment out of a scope, which makes testing and debugging considerably easier than if there was not a binding method.</p>

<p><strong>Flat Scope</strong></p>

<p>Flat scope is used to enable the use of variables and methods defined outside of a traditional scope gate (e.g., a method definition, class or module). Variables defined outside of a block can be accessed within a block, so a nifty technique is to define a class via a block rather than a using the &#8220;class&#8221; keyword, as in the following:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">dog</span> <span class="o">=</span> <span class="s2">&quot;Fido&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="no">Dog</span> <span class="o">=</span> <span class="no">Class</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">define_method</span> <span class="s2">&quot;name&quot;</span> <span class="k">do</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="n">dog</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">myDog</span> <span class="o">=</span> <span class="no">Dog</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">myDog</span><span class="o">.</span><span class="n">name</span> <span class="c1"># =&gt; Fido</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is in contrast to the &#8220;normal&#8221; way of defining a class, which acts as a scope gate and prevents previously defined variables from being accessed within the class scope.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">dog</span> <span class="o">=</span> <span class="s2">&quot;Fido&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Dog</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">name</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="n">dog</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">myDog</span> <span class="o">=</span> <span class="no">Dog</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">myDog</span><span class="o">.</span><span class="n">name</span> <span class="c1"># =&gt; ERROR: undefined local variable or method &quot;name&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Using alias_method</strong></p>

<p>The #alias method is a helpful way of changing method names while still maintaining the functionality of the old method name. It can also be used to modify programmer behavior; for example, #alias is used for deprecating functionality by providing warnings and advice on what other method to use instead of the called method, while still allowing users to call the old method.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Array</span>
</span><span class='line'>  <span class="k">alias</span> <span class="ss">:size</span> <span class="ss">:length</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">length</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Please use #size to determine array element count from now on.&quot;</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Metaprogramming in Rails</strong></p>

<p>Rails makes heavy use of metaprogramming techniques to provide a huge amount of functionality out of the box whenever a new application is created. For example, one of the benefits of using Rails and ActiveRecord specifically is that ActiveRecord creates an array of attribute accessors and dynamic finder methods that match the columns in the database tables. If you have a User model that includes columns for name, date_of_birth and phone_number, ActiveRecord will create methods like User#find_by_name, User#find_all_by_date_of_birth and User#find_or_create_by_phone_number dynamically. How does ActiveRecord know what finder methods to create? Through metaprogramming, and specifically through the #method_missing method.</p>

<p>Whenever you first make a call to a dynamic finder method in Rails, #method_missing will get triggered. If you look at the source code for ActiveRecord::Base, you&#8217;ll find a class method called #method_missing, which hijacks the method call chain for Ruby and create finder methods if the method you are calling follows the find_by pattern. The finder methods are based on the table columns in the database. In the first call to a finder method, #method_missing will create the necessary finder methods in your application, so that the second time you call that finder method, it will execute an actual block of code that corresponds with that method rather than make a call to a ghost method within #method_missing. This pattern seems to be a theme within the construction of Rails - active use of #method_missing and ghost methods to create the potential for a lot of functionality, but to not create that functionality until its actually called as adding all possible functionality at runtime could slow down the application. Rails wants to make sure that you&#8217;re going to use a dynamic finder method before it actually adds the code to your codebase. Thus, the first call to a dynamic finder generates the actual method via #method_missing.</p>

<p>Its interesting to think about the design decisions that went into the construction of ActiveRecord. The first call to a dynamic finder method is to a ghost method within #method_missing. However, this first call is enough for Rails to infer that you probably want to use the ghost method again. At this point, Rails creates an actual method for you to use in the future. Accessing a real method is generally faster than accessing a ghost method. However, adding a ton of real methods can also make your application bloated, especially if you never use most of them. Knowing some more about metaprogramming has made me appreciate even more the construction of Rails and how it enables rapid application development.</p>

<p>I particularly like this excerpt from Metaprogramming Ruby, as I think it explains well design decision for ActiveRecord as it relates to creating dynamic methods.</p>

<blockquote>
If you look at the current optimized source code [for Rails], you can try to guess some of the motivations behind it. Calling a real method is faster than calling a Ghost Method, so Rails chooses to define real methods to access attributes. On the other hand, defining a method also takes time, so Rails doesn’t do that until it’s sure that you really want to access at least one attribute on your ActiveRecord objects. Also, define_ method() is known to be slower than def on some Ruby implementations (but not on others!), and that might be one reason why the authors of Rails opted to use Strings of Code to define accessors.

None of these considerations is obvious, however. As a rule, you should never optimize your code prematurely—whether it’s metaprogramming code or not.
The source code behind dynamic attributes proves that metaprogramming can either impair your system’s performance or help you optimize it. For example, if you find out that you’re slowing down your system by calling too many Ghost Methods, you can get some performance back by defining Dynamic Methods. So, when it comes to metaprogramming, performance generally is no more of an issue than it is with any other code.
</blockquote>


<p>Overall, I&#8217;d recommend cracking open Metaprogramming Ruby if you have a decent grasp of Ruby and want to really delve into the inner workings. It&#8217;s probably not the most practical book, in that you may not use many of the metaprogramming recipes on a day-to-day basis, but its great for providing an overall understanding of how the Ruby method lookup chain works, how different classes and modules interact, etc. That said, its a dense book, and it took me a while to get through. I&#8217;ll likely try and read it again at some point, as it feels like one of those books where you can read over and over again and keep discovering new and interesting nuggets of wisdom.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using Recursion With Project Euler]]></title>
    <link href="http://eewang.github.com/blog/2013/04/28/using-recursion-with-project-euler/"/>
    <updated>2013-04-28T08:00:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/04/28/using-recursion-with-project-euler</id>
    <content type="html"><![CDATA[<p>I previously set a goal for myself to try and do one Project Euler problem every day. In retrospect, I think that goal was a little ambitious, what with all the coding, reading and blogging that I&#8217;m trying to do on a day-to-day basis. However, I was able to work in a problem earlier this week that helped me get a better grasp of using recursion in Ruby.</p>

<!--more-->


<p>For those who don&#8217;t know, recursion is a computer science concept that seems simple on its face, but can mask considerable complexity. A recursive function is basically a function that calls itself. You know how when you go to a barbershop and your barber puts a mirror up to the back of your head after the haircut? The resulting mirror-on-mirror effect that looks like a never-ending pyramid of the same image in increasingly smaller size is an example of recursion. Applying recursion in a Ruby script can be a powerful and succinct way of moving programmatically applying a pattern to a given problem until the solution is found.</p>

<p>However, using recursion can also lead to &#8220;call stack too deep&#8221; errors the same way that using a while loop without providing for some incrementor will lead to an infinite loop. Recursion can also be difficult to track mentally since each call to method is made within the execution of such method, just one &#8220;layer&#8221; above. This means that when the executing code finally reaches its terminating condition, it has to go &#8220;back&#8221; through all the previous calls to the same method. At school, we had explored recursion early on in the semester to solve the Tower of Hanoi problem, but I&#8217;ll admit that it was difficult for me to grasp and follow the logic. Thankfully, as I went through Project Euler problem 7 earlier this week, I was able to apply the principles of recursion to solve it and gain a better understanding of using recursion in the process.</p>

<p>Problem 7 asks you to find the 10,001st prime number. My strategy for solving this problem was to take a starting number, pass in prime index that I would like to solve for, then move iteratively toward that index based on the starting index (i.e. the prime index of the closest prime number less than or equal to the starting number). To do this, I created an Integer#prime? method to check if a number is prime and metaprogrammed an Integer#next_prime and Integer#previous_prime method to find the closest prime number greater than and less than, respectively, the given number. I then created an Integer#find_prime method that would recursively call itself via the Integer#move_to_next_prime method that would eventually return the value of the prime_index that was initally passed to the #find_prime method.</p>

<p>I think the code that I ended up with is okay, but I could have made other changes to make the search process of finding the n-th prime faster. For example, instead of having the script move incrementally to find the value of the n-th prime given a starting number, I could have written it so that based on the delta between the prime index of the starting number and the target prime index, the script could make a someone intelligent guess as to how much to add or subtract to the starting number to get closer to the target value. The difference between the value of the starting prime index of 10 (i.e., the 10th prime) and the 15th prime will be smaller than the difference between the 10th and 20th prime. This fact could be baked into the recursive function in order to find a better &#8220;ballpark&#8221; estimate of the target prime index value rather than just incrementing by one prime number each time the function is called.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># PROBLEM NUMBER 7</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># PROBLEM NAME</span>
</span><span class='line'><span class="c1"># 10001st prime</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># PROBLEM DESCRIPTION</span>
</span><span class='line'><span class="c1"># By listing the first six prime numbers: 2, 3, 5, 7, 11, and 13, we can see that the 6th prime is 13.</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># What is the 10 001st prime number?</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># PROCESS</span>
</span><span class='line'><span class="c1"># =&gt; I want to be able to determine a prime number by passing in the index for it within the prime number universe</span>
</span><span class='line'><span class="c1"># =&gt; Find the pattern of determining prime numbers</span>
</span><span class='line'>  <span class="c1"># =&gt; Look at factors for determining a prime number</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># ANSWER</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># =&gt; 104743</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;pry&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Integer</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">prime?</span>
</span><span class='line'>    <span class="n">prime</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>    <span class="k">if</span> <span class="nb">self</span><span class="o">.</span><span class="n">even?</span>
</span><span class='line'>      <span class="n">prime</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">even_prime_check</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="n">prime</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">odd_prime_check</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">prime</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">odd_prime_check</span>
</span><span class='line'>    <span class="n">prime</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>    <span class="n">divisor</span> <span class="o">=</span> <span class="mi">3</span>
</span><span class='line'>    <span class="k">while</span> <span class="n">prime</span> <span class="o">==</span> <span class="kp">true</span> <span class="o">&amp;&amp;</span> <span class="n">divisor</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="nb">self</span><span class="o">**</span><span class="mi">0</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="nb">self</span> <span class="o">%</span> <span class="n">divisor</span> <span class="o">==</span> <span class="mi">0</span>
</span><span class='line'>        <span class="n">prime</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="n">divisor</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">prime</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">even_prime_check</span>
</span><span class='line'>    <span class="nb">self</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">?</span> <span class="kp">true</span> <span class="p">:</span> <span class="kp">false</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">check_for_primes</span>
</span><span class='line'>    <span class="n">primes</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>    <span class="p">(</span><span class="mi">2</span><span class="o">.</span><span class="n">.self</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">prime?</span>
</span><span class='line'>        <span class="n">primes</span> <span class="o">&lt;&lt;</span> <span class="n">i</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">primes</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">sum_all_primes</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">check_for_primes</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">result</span><span class="p">,</span> <span class="n">num</span><span class="o">|</span> <span class="n">result</span> <span class="o">+</span> <span class="n">num</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">which_prime?</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">check_for_primes</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">prime_search</span><span class="p">(</span><span class="o">*</span><span class="n">searches</span><span class="p">)</span>
</span><span class='line'>    <span class="n">searches</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">search</span><span class="o">|</span>
</span><span class='line'>      <span class="n">define_method</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">search</span><span class="si">}</span><span class="s2">_prime&quot;</span> <span class="k">do</span>
</span><span class='line'>        <span class="n">prime_test</span> <span class="o">=</span> <span class="nb">self</span>
</span><span class='line'>        <span class="k">case</span> <span class="n">search</span>
</span><span class='line'>        <span class="k">when</span> <span class="ss">:next</span>
</span><span class='line'>          <span class="n">prime_test</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">self</span><span class="o">.</span><span class="n">prime?</span>
</span><span class='line'>          <span class="n">prime_test</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">until</span> <span class="n">prime_test</span><span class="o">.</span><span class="n">prime?</span>
</span><span class='line'>        <span class="k">when</span> <span class="ss">:previous</span>
</span><span class='line'>          <span class="n">prime_test</span> <span class="o">-=</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">self</span><span class="o">.</span><span class="n">prime?</span>
</span><span class='line'>          <span class="n">prime_test</span> <span class="o">-=</span> <span class="mi">1</span> <span class="k">until</span> <span class="n">prime_test</span><span class="o">.</span><span class="n">prime?</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>        <span class="n">prime_test</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">prime_search</span> <span class="ss">:next</span><span class="p">,</span> <span class="ss">:previous</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">find_prime</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="nb">self</span><span class="o">.</span><span class="n">prime?</span>
</span><span class='line'>      <span class="n">starting_prime</span> <span class="o">=</span> <span class="nb">self</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="n">starting_prime</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">previous_prime</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">starting_prime</span><span class="o">.</span><span class="n">which_prime?</span><span class="si">}</span><span class="s2"> prime: </span><span class="si">#{</span><span class="n">starting_prime</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="n">starting_index</span> <span class="o">=</span> <span class="n">starting_prime</span><span class="o">.</span><span class="n">which_prime?</span>
</span><span class='line'>    <span class="n">move_to_next_prime</span><span class="p">(</span><span class="n">starting_prime</span><span class="p">,</span> <span class="n">starting_index</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_to_next_prime</span><span class="p">(</span><span class="n">start_prime</span><span class="p">,</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">target_index</span><span class="p">)</span>
</span><span class='line'>    <span class="k">case</span>
</span><span class='line'>    <span class="k">when</span> <span class="n">start_index</span> <span class="o">==</span> <span class="n">target_index</span>
</span><span class='line'>      <span class="n">start_prime</span>
</span><span class='line'>    <span class="k">when</span> <span class="n">start_index</span> <span class="o">&lt;</span> <span class="n">target_index</span>
</span><span class='line'>      <span class="n">next_num</span> <span class="o">=</span> <span class="n">start_prime</span><span class="o">.</span><span class="n">next_prime</span>
</span><span class='line'>      <span class="n">next_num</span><span class="o">.</span><span class="n">find_prime</span><span class="p">(</span><span class="n">target_index</span><span class="p">)</span>
</span><span class='line'>    <span class="k">when</span> <span class="n">start_index</span> <span class="o">&gt;</span> <span class="n">target_index</span>
</span><span class='line'>      <span class="n">next_num</span> <span class="o">=</span> <span class="n">start_prime</span><span class="o">.</span><span class="n">previous_prime</span>
</span><span class='line'>      <span class="n">next_num</span><span class="o">.</span><span class="n">find_prime</span><span class="p">(</span><span class="n">target_index</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">binding</span><span class="o">.</span><span class="n">pry</span>
</span></code></pre></td></tr></table></div></figure>


<p>As I&#8217;ve mentioned before, working on Project Euler problems has forced me to dust off the Ruby core documentation and practice applying concepts that I learned before but may have forgotten over time. Also, given that we&#8217;ve focused so much on the abstractions of Rails over the past two months, its great to have to go back to working with just Ruby. Its not easy to make time to do Project Euler problems, but I definitely recommend trying to work on at least a few of them (or similar logic problems) just to get more practice at writing Ruby scripts.</p>

<p>Finally, I&#8217;ll leave you with some other good resources on recursion in Ruby in case you&#8217;re interested in learning more:</p>

<p><a href="http://natashatherobot.com/recursion-factorials-fibonacci-ruby/" target="_blank">Recursion and Fibonacci in Ruby</a></p>

<p><a href="http://kaibun.net/blog/2010/03/17/simple-thought-about-recursion-in-ruby/" target="_blank">Recursion in Ruby</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Flatiron Graduation]]></title>
    <link href="http://eewang.github.com/blog/2013/04/27/flatiron-graduation/"/>
    <updated>2013-04-27T07:57:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/04/27/flatiron-graduation</id>
    <content type="html"><![CDATA[<p>Yesterday was the final day of the Flatiron School semester. I&#8217;ll write a longer blog post hopefully next week with my reflections and thoughts on the 3 month program, but I just wanted to say that its been an awesome experience. I&#8217;ve met some amazing people and I&#8217;m so happy to have a skill set now that I can continue to cultivate for the rest of my life. I used to have a lot of ideas for applications or programs that could never reach fruition without knowing how to code; now, I can have an idea and write a simple exploratory Rails app or script to see if its feasible. The skill of being able to ideate and execute simultaneously is a true blessing, and I&#8217;m thankful to have had the opportunity to build it at the Flatiron School.</p>

<!--more-->


<p>Despite the end of the program, I have no plans to slow down. Sure, I&#8217;ll be heading back to Chicago next weekend for about 5 days, but I plan to keep coding whenever I&#8217;m not hanging out with friends and family. I&#8217;ll still keep going into school to code with others. I&#8217;ll still keep blogging about what I&#8217;m learning and building. I&#8217;ll still keep reading coding books and working on Project Euler problems. In many ways, the end of Flatiron just means that I&#8217;ll have more flexibility during the day to grab coffee or a longer lunch; I don&#8217;t expect the learning process to decelerate.</p>

<p>Oh, and looking for jobs. That process will start imminently. While I don&#8217;t exactly relish the idea of the job search process, it will be a great opportunity for me to meet people in the tech community and learn about what cool stuff companies in New York are building. And if you know of somewhere that looks interesting or someone you think I should meet, feel free to shoot me an e-mail (eugene.wang.77@gmail.com)!</p>

<p><em>Updated Saturday, April 27, 10:00 pm</em></p>

<p>I had the opportunity today to serve as a judge in the Big Stakes Challenge for <a href="http://defyventures.org/" target="_blank">Defy Ventures</a>. If you haven&#8217;t heard of Defy, its an entrepreneurial program for formerly incarcerated individuals. The program is structured as a mini-MBA; students have classes for a few hours two evenings during the week and all-day Saturday for about 8 months. They learn about the fundamentals of entrepreneurship - business plans, marketing, finance, operations, etc. And while they take classes, they apply their education to their own business ventures. As a judge in today&#8217;s competition (the last of three that they held throughout the program), I heard from promising entrepreneurs about a computer repair business, an artisan ice cream cart and a brand management agency, among many others. All of the men and women I heard from today have criminal records (a few spent the majority of their lives in prison), but I honestly forgot they served hard time after a few minutes. I found them to be articulate, passionate and eager to take on the challenge of (legal) entrepreneurship, and hearing their personal stories and business pitches helped me break down stereotypes I have of ex-convicts.  You can find more information about the program <a href="http://www.nytimes.com/2012/09/24/nyregion/helping-ex-criminals-develop-start-ups.html" target="_blank">here</a>.</p>

<p>After the all-day business plan competition, I attended the graduation ceremony for the students this evening. Having just gone through my own graduation ceremony at the Flatiron School yesterday, I found it interesting to compare the missions of Defy and Flatiron. Like Flatiron, Defy just wrapped up its second semester in New York City. At its core, both Flatiron and Defy are about personal transformation and rejecting the popular narrative about their respective target populations. Flatiron seeks to refute the notion that developers and coders have to come out of computer science programs, or that programming is more about solving mathematical equations than creative expression. In the same vein, Defy aims to demonstrate that ex-convicts and felony offenders are talented, hard-working individuals who just so happened to get the short end of the straw in going to prison. Both programs inspire confidence and faith that the past is not prescient about our future and that we can shape our future if only we have the right tools at our fingertips and a supporting community to encourage us along the way. Despite the vastly different curricular focus, both Flatiron and Defy believe that its never too late to make a change for the better, and that while our past experiences undoubtedly shape our present selves, they do not define the who we&#8217;ll become.</p>

<p>I&#8217;m incredibly grateful for programs like the Flatiron School and Defy Ventures, and I&#8217;m especially thankful for the desire of individuals like Adam and Avi of Flatiron and Catherine Rohr of Defy to serve their respective target communities and give people a chance to change their personal career trajectory. Society today seems to slowly ossifying into socioeconomic categories that are defined earlier and earlier in life. We&#8217;re told that what college we go to matters because the people we meet will define the rest of our lives. We&#8217;re told that how many high school AP classes we take will ripple throughout our lives because it&#8217;ll affect what college we go to. Backtracing these assumptions to their logical conclusion partially explains why tuition at &#8220;top&#8221; pre-schools can hit five digits.</p>

<p>And while I&#8217;m not saying that these early decisions don&#8217;t matter (research shows that a good early education program has a huge multiplier effect on future earnings), its dangerous to assume those decisions are destiny. Avi described in his commencement speech that his grades steadily deteriorated throughout high school and that he eventually dropped out of college. By conventional wisdom, Avi&#8217;s future should have been pretty dim. Instead, he found a way to reject the narrative that your college defines your future and is today the founder of two successful startups. Both Flatiron and Defy reminds us that humans are more malleable and mentally flexible farther along in their lives than people think; its not just children who can learn new skills and transform themselves. Flatiron and Defy are doing awesome things in New York City, and I&#8217;m humbled to have had the opportunity to play a role in the two programs.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How To Build A Simple News Reader]]></title>
    <link href="http://eewang.github.com/blog/2013/04/25/building-a-simple-news-reader/"/>
    <updated>2013-04-25T16:58:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/04/25/building-a-simple-news-reader</id>
    <content type="html"><![CDATA[<p>A Flatiron TA (Blake Johnson) recently introduced us to the &#8216;say&#8217; command in the Mac terminal. The command does exactly what you think it would - if you send in a string after the command, your computer will talk back to you! With this new-found coder superpower, I thought it would be interesting to try and build a simple news reading application. I&#8217;ve pasted the code below after the fold, or you can find my code <a href="https://github.com/eewang/automated-news-reader" target="_blank">here on Github</a>.</p>

<!--more-->


<p>I used to read the news constantly, checking my Google Reader feed or the New York Times several times an hour. Since starting at Flatiron, its been difficult for me to keep up with my regular news consumption. I try to read a number of newspapers and periodicals throughout the week, including the Economist, Atlantic, NY Mag and the NYT. With my deep-end dive into coding, however, traditional news reading has been difficult, so I&#8217;ve been trying to find new ways to get my news. For example, I started to get back into podcasts, which has been great as a way not only to get my news, but to take a break from constantly looking at screens.</p>

<p>I wanted to build a simple script that could scrape the New York Times front page and read the news back to me. As I thought about the problem, I decided to create two classes to represent the page that I wanted to scrape and the actual story itself. The code itself is pretty simple; it uses Nokogiri to open up the NYTimes front page and extracts the stories using a the &#8220;story&#8221; class css selector. Using Nokogiri to scrape a webpage converts the HTML into Nokogiri nodes, to which methods like &#8216;text&#8217; or &#8216;value&#8217; can be used to get information about the specific Nokogiri node. After extracting the stories, I could then execute terminal commands from my Ruby script using the backtick character - `.</p>

<p>The &#8220;front_page_stories&#8221; instance method in the Page class extracts all the stories from the front page. Then, the &#8220;create_stories&#8221; method goes through each story and creates a Story instance, on which it calls various methods to get the headline, byline and lede graph.</p>

<p>To get the full text of the article, I extracted the link to the full story from the front page story node and passed that link into the Nokogiri HTML parser. Each story page includes the full body text in a paragraph tag with an &#8220;itemprop = articleBody&#8221; attribute, which makes it easy to access the body text of a given article. I then save each paragraph as a separate element in an array, which can then be iterated over for the terminal &#8216;say&#8217; command to read.</p>

<p>One challenge that I had to address was the fact that the NYTimes uses different headline tags for the primary, secondary, tertiary, etc. stories. So what I did was write a Story instance method to check which headline tag was not empty for a given story. The script then takes the text value of the non-empty headline tag and applies it to the story headline attribute.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;net/http&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;nokogiri&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;pry&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Page</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:url</span><span class="p">,</span> <span class="ss">:bylines</span><span class="p">,</span> <span class="ss">:stories</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@url</span> <span class="o">=</span> <span class="n">url</span>
</span><span class='line'>    <span class="vi">@stories</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">document</span>
</span><span class='line'>    <span class="ss">Nokogiri</span><span class="p">:</span><span class="ss">:HTML</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="vi">@url</span><span class="p">))</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">front_page_stories</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;.story&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">create_stories</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">front_page_stories</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">story</span><span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">story</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;h6.byline&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>        <span class="n">s</span> <span class="o">=</span> <span class="no">Story</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>        <span class="n">s</span><span class="o">.</span><span class="n">get_headline</span><span class="p">(</span><span class="n">story</span><span class="p">)</span>
</span><span class='line'>        <span class="n">s</span><span class="o">.</span><span class="n">get_byline</span><span class="p">(</span><span class="n">story</span><span class="p">)</span>
</span><span class='line'>        <span class="n">s</span><span class="o">.</span><span class="n">get_link</span><span class="p">(</span><span class="n">story</span><span class="p">)</span>
</span><span class='line'>        <span class="n">s</span><span class="o">.</span><span class="n">get_lede_graph</span><span class="p">(</span><span class="n">story</span><span class="p">)</span>
</span><span class='line'>        <span class="vi">@stories</span> <span class="o">&lt;&lt;</span> <span class="n">s</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">read_stories</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">create_stories</span>
</span><span class='line'>    <span class="vi">@stories</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">story</span><span class="o">|</span>
</span><span class='line'>      <span class="sb">`say -v &quot;</span><span class="si">#{</span><span class="n">story</span><span class="o">.</span><span class="n">voice</span><span class="si">}</span><span class="sb">&quot; &quot;Story </span><span class="si">#{</span><span class="vi">@stories</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">story</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="sb"> of </span><span class="si">#{</span><span class="vi">@stories</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="sb">&quot;`</span>
</span><span class='line'>      <span class="n">story</span><span class="o">.</span><span class="n">speak_story</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Story</span>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:headline</span><span class="p">,</span> <span class="ss">:byline</span><span class="p">,</span> <span class="ss">:lede_graph</span><span class="p">,</span> <span class="ss">:link</span><span class="p">,</span> <span class="ss">:voice</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">VOICES</span> <span class="o">=</span> <span class="o">[</span>
</span><span class='line'>    <span class="s2">&quot;Alex&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;Bruce&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;Fred&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;Junior&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;Ralph&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;Agnes&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;Kathy&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;Princess&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;Vicki&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;Victoria&quot;</span>
</span><span class='line'>  <span class="o">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span>
</span><span class='line'>    <span class="vi">@doc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>    <span class="vi">@body_paragraphs</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>    <span class="vi">@voice</span> <span class="o">=</span> <span class="no">VOICES</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="c1"># .shuffle[0]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">doc</span>
</span><span class='line'>    <span class="vi">@doc</span> <span class="o">=</span> <span class="ss">Nokogiri</span><span class="p">:</span><span class="ss">:HTML</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="vi">@link</span><span class="p">))</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">get_link</span><span class="p">(</span><span class="n">story</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">link</span> <span class="o">=</span> <span class="n">story</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">get_byline</span><span class="p">(</span><span class="n">story</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">byline</span> <span class="o">=</span> <span class="n">story</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;h6.byline&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">get_lede_graph</span><span class="p">(</span><span class="n">story</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">lede_graph</span> <span class="o">=</span> <span class="n">story</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">get_headline</span><span class="p">(</span><span class="n">story</span><span class="p">)</span>
</span><span class='line'>    <span class="n">attrs</span> <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;h2&#39;</span><span class="p">,</span> <span class="s1">&#39;h3&#39;</span><span class="p">,</span> <span class="s1">&#39;h5&#39;</span><span class="o">]</span>
</span><span class='line'>    <span class="n">attrs</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">headline</span><span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">story</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="n">headline</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>        <span class="nb">self</span><span class="o">.</span><span class="n">headline</span> <span class="o">||=</span> <span class="n">story</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="n">headline</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">full_text</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">doc</span>
</span><span class='line'>    <span class="vi">@doc</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s2">&quot;p[itemprop=articleBody]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span>
</span><span class='line'>      <span class="vi">@body_paragraphs</span> <span class="o">&lt;&lt;</span> <span class="nb">p</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="vi">@body_paragraphs</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">speak_story</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">byline</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="sb">`say -v &quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">voice</span><span class="si">}</span><span class="sb">&quot; &quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">byline</span><span class="si">}</span><span class="sb">&quot;`</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">headline</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="sb">`say -v &quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">voice</span><span class="si">}</span><span class="sb">&quot; &quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">headline</span><span class="si">}</span><span class="sb">&quot;`</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">lede_graph</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="sb">`say -v &quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">voice</span><span class="si">}</span><span class="sb">&quot; &quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">lede_graph</span><span class="si">}</span><span class="sb">&quot;`</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">full_text</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">p</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="sb">`say -v &quot;</span><span class="si">#{</span><span class="nb">self</span><span class="o">.</span><span class="n">voice</span><span class="si">}</span><span class="sb">&quot; &quot;</span><span class="si">#{</span><span class="nb">p</span><span class="si">}</span><span class="sb">&quot;`</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">news</span> <span class="o">=</span> <span class="no">Page</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;http://www.nytimes.com&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">news</span><span class="o">.</span><span class="n">read_stories</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, I can theoretically wake up in the morning, fire up my terminal, run this script and get ready for the day as my computer reads the news to me. In practice, the computer voice isn&#8217;t all that sexy and it inaccurately pronounces some names or other proper nouns and generally has a lumpy, awkward quality to it. I&#8217;m sure there are programs out there that you can download to add custom voices to the computer that are better than the standard voices. Another feature I&#8217;d like to add would be a scrape for Twitter to add a news feed feature. Also, I&#8217;d like to add a cron job feature with the Twilio API to notify me when the NYTimes adds a banner breaking news headline to the site. I know that the NYT sends out e-mail alerts for breaking news already, but it never hurts to be the first to know!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Not All Sort Algorithms Are Created Equal]]></title>
    <link href="http://eewang.github.com/blog/2013/04/22/sort-algorithms/"/>
    <updated>2013-04-22T11:20:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/04/22/sort-algorithms</id>
    <content type="html"><![CDATA[<p>Yesterday we explored a few computer science topics, such as sort algorithms, Big O notation, linked lists and binary search nodes. I was tasked with learning more about sort algorithms, which is something I typically take for granted when coding, since Ruby has a built in #sort method (which, incidentally, uses the quick sort algorithm that I&#8217;ll go into later). At a high level, a sort algorithm is a set of instructions to follow to sort a collection (e.g., an array) based on one or multiple criterion.</p>

<!--more-->


<p>A quick <a href="http://en.wikipedia.org/wiki/Sort_algorithms" target="_blank">search</a> on Wikipedia indicates that there are quite a few sort algorithms out there to choose from. Each of them have pros and cons depending on the context in which they are used. Applying a bubble sort algorithm to sort an array of numbers performs differently (in terms of computation speed) depending on how large the array is (e.g., 2 numbers or 2000 numbers?) or how organized the array is (e.g., is it entirely randomized or mostly sorted already?). For large, randomized data sets, an insertion sort may perform better than a bubble sort, but a bubble sort may perform better than an insertion sort for small sets.</p>

<p>Sort algorithms can be categorized among several parameters, including efficiency, stability and computational complexity. Efficiency is a proxy for speed, or how quickly it takes for a given set to be sorted by the algorithm in question. This can vary considerably by the complexity and order of the input set.</p>

<p>Stability is a concept that considers the original placement of a value within a set. For example, in the array [1, 2, 3, 4, 2], a correctly sorted list will come out to [1, 2, 2, 3, 4]. A sort algorithm is stable if the first &#8216;2&#8217; in the original array is in the first &#8216;2&#8217; in the sorted array and the second &#8216;2&#8217; in the original array is the second &#8216;2&#8217; in the sorted array. This example of stability is a bit contrived in this example, but is more relevant for sorting a set of objects that have more than one attribute. For example, say I have a list of NBA point guards and various stats (e.g., points per game, assists per game, etc.). If two point guards have the exact same PPG and I run a sort algorithm that does not lead to a stable result, then each time I run that sort algorithm I could have a different order of players, even if by PPG, the list is correctly sorted.</p>

<p>Computational complexity relates to what operations are used to actually sort the list and determine relative size. For example, a comparison sorting algorithm, like a bubble sort or insertion sort, uses relational operators (e.g., &lt;=, >=, !=) to determine where a given value should be placed in a sorted list. Conversely, an adaptive sort uses the existing sort order of a set to determine how the sort performs, with the basic understanding that the better sorted an initial input is, the faster the sort algorithm should perform.</p>

<p>Here&#8217;s a quick description on the sort algorithms that seemed to come up most frequently in my research on the topic. I tried to understand the most common search algorithms and implement them in Ruby. I also benchmarked the performance of the algorithms in question for an already sorted array, a reverse sorted array and a randomized array. Benchmarking the performance of the sort algorithms was helpful for me to better understand when you might want to use a bubble sort over a selection sort. You can see my full code below (note that the code is far from perfect - if you have any comments on anything that I may have missed or done inefficiently, please let me know!).</p>

<p><strong>Bubble Sort</strong></p>

<p>To sort an array of numbers (the simplest example of a set) a bubble sort algorithm goes through each index in the array and compares the value with the following value. If the first value is larger than the second value, then the two values will be switched (assuming the sort is done in ascending order). This pattern is repeated until all the numbers are sorted. On the first iteration, the largest number will &#8220;bubble&#8221; to the end of the array (i.e., index of n-1). On the second iteration, the second largest number will &#8220;bubble&#8221; to the n-2 position in the array. And so on until the array is sorted.</p>

<p>The bubble sort algorithm performs decently well on small sets, but performance degrades as sets get larger. The downside of the bubble sort is that small numbers toward the end of a set will slow down the sort as the algorithm has to move them one-by-one all the way to the front of the set. A modified version of the bubble sort is the comb sort, which helps address the  small number issue that the bubble sort presents.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Array</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">bubble_sort</span>
</span><span class='line'>    <span class="n">length</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="k">until</span> <span class="nb">self</span><span class="o">.</span><span class="n">sorted?</span>
</span><span class='line'>      <span class="c1"># puts self.join(&quot;&quot;)</span>
</span><span class='line'>      <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">.</span><span class="n">.length</span><span class="o">-</span><span class="mi">2</span> <span class="k">do</span>
</span><span class='line'>        <span class="n">compare</span> <span class="o">=</span> <span class="o">[</span><span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span> <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">]]</span>
</span><span class='line'>        <span class="k">if</span> <span class="n">compare</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">&gt;</span> <span class="n">compare</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>          <span class="n">switch_num</span> <span class="o">=</span> <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
</span><span class='line'>          <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="nb">self</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span>
</span><span class='line'>          <span class="nb">self</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">switch_num</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="nb">self</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The bubble sort takes an array and goes through each value, switching that value with the next value if the next value is smaller than the first value. Each time the sort goes through the array, it checks if the array is sorted. If it is, then it stops, otherwise it continues to sort the array.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">58927384</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">bubble_sort</span>
</span><span class='line'>
</span><span class='line'><span class="mi">58927384</span>
</span><span class='line'><span class="mi">58273849</span>
</span><span class='line'><span class="mi">52738489</span>
</span><span class='line'><span class="mi">25374889</span>
</span><span class='line'><span class="mi">23547889</span>
</span><span class='line'>
</span><span class='line'><span class="o">=&gt;</span> <span class="o">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Selection Sort</strong></p>

<p>A selection sort starts by taking the first element in a list of numbers. Then, the algorithm goes through all of the remaining numbers and finds the minimum value, which it then swaps positions with the first number. After this first iteration, the smallest number in the array is now in the correct (i.e., first) position. This process continues until n - 1 iterations have been made and all numbers are sorted.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Array</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">selection_sort</span>
</span><span class='line'>    <span class="n">length</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="n">sorted</span> <span class="o">=</span> <span class="nb">self</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">.</span><span class="n">.length</span><span class="o">-</span><span class="mi">1</span> <span class="k">do</span>
</span><span class='line'>      <span class="c1"># puts sorted.join(&quot;&quot;)</span>
</span><span class='line'>      <span class="n">search_array</span> <span class="o">=</span> <span class="n">sorted</span><span class="o">[</span><span class="n">i</span><span class="o">.</span><span class="n">.</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>      <span class="n">current_num</span> <span class="o">=</span> <span class="n">sorted</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
</span><span class='line'>      <span class="n">min_num</span> <span class="o">=</span> <span class="n">search_array</span><span class="o">.</span><span class="n">min</span>
</span><span class='line'>      <span class="n">switch_index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">search_array</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">min_num</span><span class="p">)</span>
</span><span class='line'>      <span class="n">sorted</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">min_num</span>
</span><span class='line'>      <span class="n">sorted</span><span class="o">[</span><span class="n">switch_index</span><span class="o">]</span> <span class="o">=</span> <span class="n">current_num</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">sorted</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This sort algorithm will go through an array and for each value it checks, it will find the minimum value for the sub-set of the array following the value it is checking. It will then replace the current value with the minimum value that it finds. This way, the smallest number of a successively smaller sub-set of the original array is placed just before such sub-set. By the time the loop gets to the end of the array, the array has been sorted.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">58927384</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">selection_sort</span>
</span><span class='line'>
</span><span class='line'><span class="mi">58927384</span>
</span><span class='line'><span class="mi">28957384</span>
</span><span class='line'><span class="mi">23957884</span>
</span><span class='line'><span class="mi">23457889</span>
</span><span class='line'><span class="mi">23457889</span>
</span><span class='line'><span class="mi">23457889</span>
</span><span class='line'><span class="mi">23457889</span>
</span><span class='line'><span class="mi">23457889</span>
</span><span class='line'>
</span><span class='line'><span class="o">=&gt;</span> <span class="o">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Insertion Sort</strong></p>

<p>An insertion sort starts by taking the last two numbers in an array. The algorithm then takes each number in the original array and puts that number in the correct place in the new sorted array, and continues that pattern until all of the original array is now in a sorted new array.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Array</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">insertion_sort</span>
</span><span class='line'>    <span class="n">length</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="n">sorted</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>    <span class="n">sorted</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="nb">self</span><span class="o">[</span><span class="n">length</span><span class="o">-</span><span class="mi">2</span><span class="o">.</span><span class="n">.length</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">max</span><span class="p">)</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="nb">self</span><span class="o">[</span><span class="n">length</span><span class="o">-</span><span class="mi">2</span><span class="o">.</span><span class="n">.length</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">min</span><span class="p">)</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">length</span><span class="o">-</span><span class="mi">2</span> <span class="k">do</span>
</span><span class='line'>      <span class="c1"># puts sorted.join(&quot;&quot;)</span>
</span><span class='line'>      <span class="n">num</span> <span class="o">=</span> <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
</span><span class='line'>      <span class="n">insert_at</span> <span class="o">=</span> <span class="n">sorted</span><span class="o">.</span><span class="n">max</span> <span class="o">&lt;</span> <span class="n">num</span> <span class="p">?</span> <span class="n">sorted</span><span class="o">.</span><span class="n">length</span> <span class="p">:</span> <span class="n">sorted</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">int</span><span class="o">|</span> <span class="n">int</span> <span class="o">-</span> <span class="n">num</span> <span class="p">}</span><span class="o">.</span><span class="n">index</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">sorted</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_at</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">sorted</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This sort code creates a second array of two numbers, then goes back through the original array and puts each number in the correct place in the second array. The &#8220;insert_at&#8221; variable determines where in the second array the value from the original array should be included.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">58927384</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">insertion_sort</span>
</span><span class='line'>
</span><span class='line'><span class="mi">48</span>
</span><span class='line'><span class="mi">458</span>
</span><span class='line'><span class="mi">4588</span>
</span><span class='line'><span class="mi">45889</span>
</span><span class='line'><span class="mi">245889</span>
</span><span class='line'><span class="mi">2457889</span>
</span><span class='line'>
</span><span class='line'><span class="o">=&gt;</span> <span class="o">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Merge Sort</strong></p>

<p>Merge sort is an algorithm that recursively breaks down a set until each item is in its own array. Then, the algorithm recreates the set by merging successively larger sub-sets in an orderly fashion until the original set is sorted. This was a challenging one for me to conceptualize, and I&#8217;ll admit that the code below was mostly taken from the Phil Crissman blog I link to below. The speed of the merge sort comes from the fact that its easier to a sorted list with another already sorted list. The algorithm breaks down a large array until it can reconstruct the set by merging sorted sub-sets.</p>

<p><strong>Quick Sort</strong></p>

<p>I didn&#8217;t implement a quick sort algorithm, but the basic notion behind the quick sort algorithm is that it selects a element in the set called the pivot (typically, the median value), moves all values less than the pivot to before the pivot and all values greater than the pivot to after the pivot. After this first iteration, the pivot value is in the correct place in the set, even if the values before and after the pivot are not in the correct order. Then, this process is repeated for the sub-sets smaller and larger than the pivot value until the entire set is sorted.</p>

<p>The quick sort seems to be a pretty fast and efficient algorithm, and its used in Ruby for the array#sort algorithm. However, it doesn&#8217;t seem to be the most stable algorithm, as the original set order is not preserved in the event of a perfect match between two values. Conceptually, I find this sort algorithm the most interesting, because it uses contextual clues to sort more efficiently. The Wikipedia entry for <a href="https://en.wikipedia.org/wiki/Quicksort" target="_blank">quick sort</a> has a great graphic illustrating how the quick sort works. I might try and implement my own quick sort at some point; if I do, I&#8217;ll definitely update this post!</p>

<p><strong>Benchmarking</strong></p>

<p>For each of these tests, I created a random number and converted that number into an array using the number#array function in the code at the bottom. For the quick sort, I used the Ruby array#sort method. I wanted to see how the sort algorithms I chose to examine varied based on the size of the array and the sort level of the input array. I tested each algorithm on an already sorted array, a reverse sorted array and a randomly sorted array.</p>

<p>Let me just say upfront that I think the merge sort implementation seems off here. Based on my reading, the merge sort should be a relatively efficient and fast sort algorithm (falling below a quick sort but above the other sort algorithms), but for some reason the merge sort I examined doesn&#8217;t perform that well. I suspect that its because the method is making an unnecessary number of recursive loops. It would be interesting to examine more closely, but I&#8217;m afraid that this may be a rabbit hole that I don&#8217;t have the expertise (or time) yet to delve fully into.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>number = 58927384
</span><span class='line'>
</span><span class='line'>Sort Algorithm (input type)     Sort Time (ms)
</span><span class='line'>----------------------------------------------
</span><span class='line'>Bubble Sort (sorted)            0.013
</span><span class='line'>Insertion Sort (sorted)         0.035
</span><span class='line'>Selection Sort (sorted)         0.038
</span><span class='line'>Merge Sort (sorted)             0.093
</span><span class='line'>Quick Sort (sorted)             0.011
</span><span class='line'>  
</span><span class='line'>Bubble Sort (reverse)           0.055
</span><span class='line'>Insertion Sort (reverse)        0.028
</span><span class='line'>Selection Sort (reverse)        0.027
</span><span class='line'>Merge Sort (reverse)            0.066
</span><span class='line'>Quick Sort (reverse)            0.007
</span><span class='line'>  
</span><span class='line'>Bubble Sort (random)            0.045
</span><span class='line'>Insertion Sort (random)         0.027
</span><span class='line'>Selection Sort (random)         0.027
</span><span class='line'>Merge Sort (random)             0.067
</span><span class='line'>Quick Sort (random)             0.006</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>number = 52398471342
</span><span class='line'>
</span><span class='line'>Sort Algorithm (input type)     Sort Time (ms)
</span><span class='line'>----------------------------------------------
</span><span class='line'>Bubble Sort (sorted)            0.012
</span><span class='line'>Insertion Sort (sorted)         0.041
</span><span class='line'>Selection Sort (sorted)         0.038
</span><span class='line'>Merge Sort (sorted)             0.105
</span><span class='line'>Quick Sort (sorted)             0.008
</span><span class='line'>  
</span><span class='line'>Bubble Sort (reverse)           0.094
</span><span class='line'>Insertion Sort (reverse)        0.041
</span><span class='line'>Selection Sort (reverse)        0.035
</span><span class='line'>Merge Sort (reverse)            0.095
</span><span class='line'>Quick Sort (reverse)            0.007
</span><span class='line'>  
</span><span class='line'>Bubble Sort (random)            0.083
</span><span class='line'>Insertion Sort (random)         0.04
</span><span class='line'>Selection Sort (random)         0.034
</span><span class='line'>Merge Sort (random)             0.096
</span><span class='line'>Quick Sort (random)             0.005</span></code></pre></td></tr></table></div></figure>


<p>For relatively small arrays, there doesn&#8217;t seem to be a huge difference in performance, but its clear that the quick sort is the most efficient method, which should come as no surprise since its the actual Ruby array#sort method. My sort algorithm implementations are no match for the Ruby sort algorithm.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>number = 2984579834759824759082347509823475098274509827409582745980274359872490
</span><span class='line'>8572890457209384572908345790284570981374908274598027450923845092846738945729834
</span><span class='line'>579873465934758923745897459083745890273490587246897234985739485634596394
</span><span class='line'>
</span><span class='line'>Sort Algorithm (input type)     Sort Time (ms)
</span><span class='line'>----------------------------------------------
</span><span class='line'>Bubble Sort (sorted)            0.075
</span><span class='line'>Insertion Sort (sorted)         5.182
</span><span class='line'>Selection Sort (sorted)         5.079
</span><span class='line'>Merge Sort (sorted)             5.528
</span><span class='line'>Quick Sort (sorted)             0.01
</span><span class='line'>  
</span><span class='line'>Bubble Sort (reverse)           22.589
</span><span class='line'>Insertion Sort (reverse)        3.836
</span><span class='line'>Selection Sort (reverse)        1.37
</span><span class='line'>Merge Sort (reverse)            11.13
</span><span class='line'>Quick Sort (reverse)            0.014
</span><span class='line'>  
</span><span class='line'>Bubble Sort (random)            17.069
</span><span class='line'>Insertion Sort (random)         4.37
</span><span class='line'>Selection Sort (random)         1.344
</span><span class='line'>Merge Sort (random)             8.258
</span><span class='line'>Quick Sort (random)             0.007</span></code></pre></td></tr></table></div></figure>


<p>For larger sets, the efficiency loss becomes much more evident for the non quick sort algorithms. The bubble sort, for example, performs very well for an already sorted list, but falls way behind for lists that are not well sorted (randomized or in reverse sort order). The insertion and selection sorts seem to perform relatively similarly, although it appears that the selection sort seems to be consistely better than the insertion sort. This further supports the notion that which sort algorithm is &#8220;best&#8221; is context-dependent and varies based on the complexity and size of the set to be sorted. That said, there are certain sort algorithms that are generally worse than others (e.g., the bubble sort is probably sub-optimal in most all cases).</p>

<p>The main lesson I learned throughout trying to implement my own sort algorithms is to not try and implement my own sort algorithms. Ruby seems to have the sort method down pretty well, although I&#8217;ve read that there are some edge cases where the array#sort method lags behind custom sort algorithms. At this point in my programming career though, I can probably rely on array#sort for most all of my sorting needs.</p>

<p>Needless to say though, implementing your own sort algorithm is a pretty interesting intellectual exercise. It forces you to use less abstract Ruby methods (I tried to just use for loops in my implementation), which helps you develop a better understanding and appreciation for more abstract Ruby methods like array#collect or array#inject.</p>

<p><strong>Good Resources:</strong></p>

<p>Here are a few good web resources about sorting algorithms. I actually found the Wikipedia entry about sort algorithms to be remarkably helpful, as well as a few of the links included within the page.</p>

<p><a href="https://en.wikipedia.org/wiki/Sort_algorithm" target="_blank">https://en.wikipedia.org/wiki/Sort_algorithm</a></p>

<p><a href="http://www.sorting-algorithms.com/" target="_blank" >http://www.sorting-algorithms.com/</a></p>

<p><a href="http://atschool.eduweb.co.uk/mbaker/sorts.html" target="_blank">http://atschool.eduweb.co.uk/mbaker/sorts.html</a></p>

<p><a href="http://blog.8thlight.com/will-warner/2013/03/26/stable-sorting-in-ruby.html" target="_blank">http://blog.8thlight.com/will-warner/2013/03/26/stable-sorting-in-ruby.html</a></p>

<p><a href="http://philcrissman.com/2010/07/18/how-not-to-write-sorting-algorithms-in-ruby/" target="_blank">http://philcrissman.com/2010/07/18/how-not-to-write-sorting-algorithms-in-ruby/</a></p>

<hr />

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;pry&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;benchmark&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Fixnum</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">array</span>
</span><span class='line'>    <span class="n">array</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">i</span><span class="o">.</span><span class="n">to_i</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">array</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Bignum</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">array</span>
</span><span class='line'>    <span class="n">array</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">i</span><span class="o">.</span><span class="n">to_i</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">array</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Array</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">reverse_array</span>
</span><span class='line'>    <span class="n">reversed_array</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>    <span class="n">size</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">length</span>
</span><span class='line'>    <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>      <span class="n">reversed_array</span> <span class="o">&lt;&lt;</span> <span class="nb">self</span><span class="o">[</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="o">]</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">reversed_array</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">sorted?</span>
</span><span class='line'>    <span class="n">sorted</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="k">while</span> <span class="n">sorted</span> <span class="o">==</span> <span class="kp">true</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&gt;</span> <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>        <span class="n">sorted</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">sorted</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">bubble_sort</span>
</span><span class='line'>    <span class="n">length</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="k">until</span> <span class="nb">self</span><span class="o">.</span><span class="n">sorted?</span>
</span><span class='line'>      <span class="c1"># puts self.join(&quot;&quot;)</span>
</span><span class='line'>      <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">.</span><span class="n">.length</span><span class="o">-</span><span class="mi">2</span> <span class="k">do</span>
</span><span class='line'>        <span class="n">compare</span> <span class="o">=</span> <span class="o">[</span><span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span> <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">]]</span>
</span><span class='line'>        <span class="k">if</span> <span class="n">compare</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">&gt;</span> <span class="n">compare</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>          <span class="n">switch_num</span> <span class="o">=</span> <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
</span><span class='line'>          <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="nb">self</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span>
</span><span class='line'>          <span class="nb">self</span><span class="o">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">switch_num</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="nb">self</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">selection_sort</span>
</span><span class='line'>    <span class="n">length</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="n">sorted</span> <span class="o">=</span> <span class="nb">self</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">.</span><span class="n">.length</span><span class="o">-</span><span class="mi">1</span> <span class="k">do</span>
</span><span class='line'>      <span class="c1"># puts sorted.join(&quot;&quot;)</span>
</span><span class='line'>      <span class="n">search_array</span> <span class="o">=</span> <span class="n">sorted</span><span class="o">[</span><span class="n">i</span><span class="o">.</span><span class="n">.</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>      <span class="n">current_num</span> <span class="o">=</span> <span class="n">sorted</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
</span><span class='line'>      <span class="n">min_num</span> <span class="o">=</span> <span class="n">search_array</span><span class="o">.</span><span class="n">min</span>
</span><span class='line'>      <span class="n">switch_index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">search_array</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">min_num</span><span class="p">)</span>
</span><span class='line'>      <span class="n">sorted</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">min_num</span>
</span><span class='line'>      <span class="n">sorted</span><span class="o">[</span><span class="n">switch_index</span><span class="o">]</span> <span class="o">=</span> <span class="n">current_num</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">sorted</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">insertion_sort</span>
</span><span class='line'>    <span class="n">length</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="n">sorted</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>    <span class="n">sorted</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="nb">self</span><span class="o">[</span><span class="n">length</span><span class="o">-</span><span class="mi">2</span><span class="o">.</span><span class="n">.length</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">max</span><span class="p">)</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="nb">self</span><span class="o">[</span><span class="n">length</span><span class="o">-</span><span class="mi">2</span><span class="o">.</span><span class="n">.length</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">min</span><span class="p">)</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">length</span><span class="o">-</span><span class="mi">2</span> <span class="k">do</span>
</span><span class='line'>      <span class="c1"># puts sorted.join(&quot;&quot;)</span>
</span><span class='line'>      <span class="n">num</span> <span class="o">=</span> <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
</span><span class='line'>      <span class="n">insert_at</span> <span class="o">=</span> <span class="n">sorted</span><span class="o">.</span><span class="n">max</span> <span class="o">&lt;</span> <span class="n">num</span> <span class="p">?</span> <span class="n">sorted</span><span class="o">.</span><span class="n">length</span> <span class="p">:</span> <span class="n">sorted</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">int</span><span class="o">|</span> <span class="n">int</span> <span class="o">-</span> <span class="n">num</span> <span class="p">}</span><span class="o">.</span><span class="n">index</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">sorted</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_at</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">sorted</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">merge_sort</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span>
</span><span class='line'>    <span class="c1"># puts &quot;starting merge_sort&quot;</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">first</span> <span class="o">&lt;</span> <span class="n">last</span>
</span><span class='line'>      <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">last</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span><span class='line'>      <span class="c1"># puts &quot;starting first recursive loop: self: #{self}; first: #{first}; mid: #{mid}; last: #{last};&quot;</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">merge_sort</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
</span><span class='line'>      <span class="c1"># puts &quot;starting second recursive loop: self: #{self}; first: #{first}, mid: #{mid+1}, last: #{last}&quot;</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">merge_sort</span><span class="p">(</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span>
</span><span class='line'>      <span class="c1"># puts &quot;start merge: self: #{self}; first: #{first}; mid: #{mid + 1}; last: #{last}&quot;</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span>
</span><span class='line'>      <span class="c1"># puts &quot;done&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="c1"># puts self[0..-2].join(&quot;&quot;)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">quick_sort</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">sort_benchmark</span>
</span><span class='line'>    <span class="n">sorted_order</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">insertion_sort</span>
</span><span class='line'>    <span class="n">sorted_reverse_order</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">insertion_sort</span><span class="o">.</span><span class="n">reverse_array</span>
</span><span class='line'>    <span class="n">random_order</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">shuffle</span>
</span><span class='line'>
</span><span class='line'>    <span class="no">Benchmark</span><span class="o">.</span><span class="n">bm</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Bubble Sort (sorted):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">sorted_order</span><span class="o">.</span><span class="n">bubble_sort</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Insertion Sort (sorted):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">sorted_order</span><span class="o">.</span><span class="n">insertion_sort</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Selection Sort (sorted):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">sorted_order</span><span class="o">.</span><span class="n">selection_sort</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Merge Sort (sorted):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">sorted_order</span><span class="o">.</span><span class="n">merge_sort</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Bubble Sort (reverse):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">sorted_reverse_order</span><span class="o">.</span><span class="n">bubble_sort</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Insertion Sort (reverse):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">sorted_reverse_order</span><span class="o">.</span><span class="n">insertion_sort</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Selection Sort (reverse):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">sorted_reverse_order</span><span class="o">.</span><span class="n">selection_sort</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Merge Sort (reverse):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">sorted_reverse_order</span><span class="o">.</span><span class="n">merge_sort</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Bubble Sort (random):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">random_order</span><span class="o">.</span><span class="n">bubble_sort</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Insertion Sort (random):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">random_order</span><span class="o">.</span><span class="n">insertion_sort</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Selection Sort (random):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">random_order</span><span class="o">.</span><span class="n">selection_sort</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Merge Sort (random):&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">random_order</span><span class="o">.</span><span class="n">merge_sort</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">protected</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span>
</span><span class='line'>    <span class="n">left</span> <span class="o">=</span> <span class="nb">self</span><span class="o">[</span><span class="n">first</span><span class="o">.</span><span class="n">.mid</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]</span>
</span><span class='line'>    <span class="n">right</span> <span class="o">=</span> <span class="nb">self</span><span class="o">[</span><span class="n">mid</span><span class="o">.</span><span class="n">.last</span><span class="o">]</span>
</span><span class='line'>    <span class="n">left</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="n">right</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="c1"># puts &quot;MERGE (before) - self: #{self}; left: #{left}; right: #{right}&quot;</span>
</span><span class='line'>    <span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="n">.last</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">n</span><span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">left</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="o">[</span><span class="n">j</span><span class="o">]</span>
</span><span class='line'>        <span class="nb">self</span><span class="o">[</span><span class="n">n</span><span class="o">]</span> <span class="o">=</span> <span class="n">left</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
</span><span class='line'>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="nb">self</span><span class="o">[</span><span class="n">n</span><span class="o">]</span> <span class="o">=</span> <span class="n">right</span><span class="o">[</span><span class="n">j</span><span class="o">]</span>
</span><span class='line'>        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="c1"># puts &quot;MERGE (after) - self: #{self}; left: #{left}; right: #{right}&quot;</span>
</span><span class='line'>    <span class="c1"># self[0..-2]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">binding</span><span class="o">.</span><span class="n">pry</span>
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Of Science Fairs and Space Apps (Flatiron - Week 11)]]></title>
    <link href="http://eewang.github.com/blog/2013/04/21/science-fairs-and-space-apps-flatiron-week-11/"/>
    <updated>2013-04-21T21:56:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/04/21/science-fairs-and-space-apps-flatiron-week-11</id>
    <content type="html"><![CDATA[<p>I can hardly believe that there is only one week left in the Flatiron School. This past week we had our Science Fair where we showed off the applications that we had been building for most of the second half of the semester. I talked about <a href="http://handrai.se" target="_blank">HandRaise</a> and <a href="http://viewfinder.io" target="_blank">ViewFinder</a>, the two apps that I&#8217;ve spent the most time building. We had a strong showing from the NYC tech community; I was definitely exhausted by the end of the four-hour long event.</p>

<!--more-->


<p>Most of the week other than the Science Fair was spent working on apps. This next week will be pretty heavy on testing (we worked some on Rspec the previous week) and interview prep as the program wraps up. There are also a few side projects that I&#8217;d like to focus on more. Also, I&#8217;m hoping to write a post looking back on my Flatiron experience toward the end of this week and early next, as well as my next goals that I hope others both in Flatiron and in the dev community more broadly can hold me accountable to.</p>

<p>This weekend me and a few other Flatiron classmates went to <a href="http://spaceappschallenge.org/" target="_blank">NYC Space Apps</a>. The hackathon was sponsored by NASA and focused on an array of space- and not-so-space-related projects. While other projects focused on using Arduinos to build space-related hardware to an Asteroid mapper, our project was to build an app to help people discover ways to boost energy efficiency and save money. Specifically, we were hoping to build a social tool for people to input in information about their energy and gas bills, see how much they pay relative to the neighborhood average and their friends (via Facebook OAuth) and, ultimately, discover relevant incentive programs (often tax credits or rebates offered at the federal, state and local levels) that they can use to lower their energy bills. It didn&#8217;t have anything to do with space, but here&#8217;s <a href="http://spaceappschallenge.org/challenge/mobile-incentives-tied-to-utility-rates/" target="_blank">proof</a> that it was actually a project on offer. Its a conceptually interesting idea, but one that we found was difficult to put together as we would have liked to do ideally within the course of a hackathon weekend. And while we didn&#8217;t end up presenting our product, I think I learned a few useful lessons for future hackathons.</p>

<p><strong>1) Establish a clear workflow </strong> - At Flatiron, I take for granted my HandRaise team&#8217;s process of pushing code to a feature branch, submitting pull requests and requiring the developer to explain the code to the pull request acceptor. I think this is a solid process, but it may not be the best process for a hackathon, where code is pushed more regularly. I found it difficult to work on a project with so many people all pushing code at the same time. I&#8217;m not sure what the best git process is for a hackathon, but whatever is decided, make sure the whole team agrees to it and is communicating regularly on what they&#8217;re pushing to either the master or staging branch.</p>

<p><strong>2) Use the recommended APIs </strong> - Hackathons often encourage participants to use the APIs of the sponsoring firms, and Space Apps was no different. Companies like FourSquare, TokBox and 10gen were there to talk about their products and APIs. While we had to listen to some marketing pitches early on, I would have liked to try and integrate the sponsoring company APIs more into the product we tried to build, if only to get the practice and be considered in the running for the best app to use a given API.</p>

<p><strong>3) Meet people </strong> - This mostly goes without saying, but hackathons are an awesome way to meet people in the development community. Its not easy to balance the desire to hack away and build something with being social, but its important to see what others are working on and trying to create. I find inspiration in the creative pursuits of others, and hackathons are a great way to see how people can bring an array of different skills to the table to be productive and create cool stuff.</p>

<p><strong>4) Start hacking early and iterate quickly</strong> - An agile development process is all the rage (so hot right now), and hackathons are a great way to put to apply agile best practices. When we were discussing what to do for the hackathon on Saturday morning, I think we spent too much time planning out our application and not enough time just hacking away. In part this was unavoidable given the size of our team (we had about 10 people at one point), but in general, its a good idea to have something small to start with and just see where that goes.</p>

<p><strong>5) Think big, but start (and demo) small</strong> - Its great to think of how your hackathon app might change lives, but in reality, its best to focus tightly in on a single user flow that can be reliably demoed by the end of the hackathon. Best for the team to each work on different components of the same flow or feature than for each member to work on the first part of multiple features.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[In Praise of Project Euler]]></title>
    <link href="http://eewang.github.com/blog/2013/04/17/in-praise-of-project-euler/"/>
    <updated>2013-04-17T16:39:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/04/17/in-praise-of-project-euler</id>
    <content type="html"><![CDATA[<p>On the suggestion of my Flatiron classmates <a href="http://chickenriceplatter.github.io/" target="_blank">David</a> and <a href="http://andrewcallahan.github.io" target="_blank">Andrew</a>, I started trying out <a href="http://projecteuler.net/" target="_blank">Project Euler</a> recently. For the uninitiated, Project Euler is a series of math problems aptly named after the famed mathemetician Leonhard Euler, known for such learned things like fluid dynamics, number theory and calculus. Project Euler is effectively a database of math problems that are intended to be solved using code (any language can be used; I&#8217;m using Ruby). The questions test your logical thinking skills, and while they&#8217;re named after a mathemetician, the actual math necessary is more along the lines of high school math (e.g., prime numbers, factoring, etc.). This is not to diminish the difficulty of these problems - some of them are quite challenging - but rather to distinguish between the problem solving skills, which Project Euler helps build, versus pure math skill, which is more the province of a graduate school program. I&#8217;ve also throw my efforts to solve these problems on Github if you want to <a href="https://github.com/eewang/project-euler" target="_blank">check them out</a>.</p>

<!--more-->


<p>I&#8217;ve only completed about 5 problems, but I&#8217;m already an advocate of trying them out. I like Project Euler because the problems are challenging enough where they really force you to build a clear, logical problem solving process yet not so obscure that you need to break out your AP Calculus book. Don&#8217;t be turned away from the problems because of the math - the biggest challenge is taking the large problem and breaking it down small-step-by-small-step.</p>

<p>Here&#8217;s an example problem:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>If we list all the natural numbers below 10 that are multiples of 3 or 5, 
</span><span class='line'>we get 3, 5, 6 and 9. The sum of these multiples is 23. 
</span><span class='line'>Find the sum of all the multiples of 3 or 5 below 1000.</span></code></pre></td></tr></table></div></figure>


<p>As you can see, the problems are challenging but manageable. The prompt typically has an example pattern and then asks you to extrapolate that pattern to some large number (in this case, 1000). Here are the main reasons why I think its great to try a few Project Euler problems:</p>

<p><strong>1) Great mental exercise</strong></p>

<p>I&#8217;m trying to average a problem a day as a form of mental exercise. While doing Project Euler problems probably won&#8217;t directly make you a better Rails programmer, it will boost your overall problem solving process. And what else is coding at its core but implementing a clear process to solving problems via technology? Just as going for a 6-mile run today may not keep you from getting a cold tomorrow, doing Project Euler problems won&#8217;t help you solve that nasty bug in your code today, but having a consistent habit of problem solving exercise will make your mind healthier in the long run.</p>

<p><strong>2) Learning core Ruby</strong></p>

<p>Having to solve Project Euler problems has forced me back into the core Ruby documentation to try and find creative solutions. For example, I don&#8217;t typically use Ruby&#8217;s &#8216;inject&#8217; method in my day-to-day coding. Inject is a pretty high-level Ruby function that allows you to specify an initial value and apply a code block to an Enumerable (e.g., an array), the result of which becomes the initial value in the following iteration. Most of the code I&#8217;ve written rely on the less abstract &#8216;collect&#8217; or &#8216;map&#8217; methods in Ruby. However, I&#8217;ve rediscovered the utility of the inject method since Project Euler problems tend to include some sort of iterative sum or product. I won&#8217;t go into the details of the inject method here, but you can find more information about it in <a href="http://blog.jayfields.com/2008/03/ruby-inject.html" target="_blank">this blog post</a> if you&#8217;re interested.</p>

<p><strong>3) Refactoring practice</strong></p>

<p>Refactoring is the near-constant process of changing code without affecting what the user sees. Its the middle part of the &#8220;make it work, make it right, make it fast&#8221; adage. Recognizing patterns and understanding the tradeoffs included in applying certain methods or approaching a problem in a certain way are critical to skillful refactoring. Project Euler problems really help hammer in the practice of always looking over your code and finding ways to refactor it.</p>

<p>I&#8217;ve started taking a three-pronged approach to solving Project Euler problems. First, I&#8217;ll try and solve the problem for a smaller number (e.g., less than 100) with whatever code works. Second, I&#8217;ll solve the problem for the large number stated in the Project Euler prompt. Finally, I&#8217;ll refactor the code into an object-oriented manner, either by creating my own class or monkey-patching an existing Ruby class (often, the Integer class). This three-step process has helped me practice raw problem-solving and get into the habit of breaking down complex problems into small, simple tasks. Refactoring is a universal coding skill, so I&#8217;m hopeful that Project Euler will help me develop a better sense for patterns and make me a better problem solver.</p>

<p><strong>4) Creative problem solving</strong></p>

<p>This reason falls in line with the refactoring practice Project Euler provides. As the cliche goes, there&#8217;s often more than one way to skin a cat, and problem solving is no different. An example of this is the code below (warning: spoiler alert) that I wrote to solve Project Euler problem 8. The problem provides a 1000-digit number and you are required to find the greatest product of any five consecutive digits.</p>

<p>When I was thinking about this problem, I could see a few solutions. One way it could be done would be to go through the number in 5-digit chunks, basically creating sub-arrays out of the number, storing the value into a products array, then returning the maximum value. Another way to solve the problem would be to find the product of 5-digit chunks, store the result in a variable, then replace the value of that variable with subsequent products only if such product is larger. Yet another way to solve the problem would be to calculate the product of a 5-digit chunk, then iteratively check whether the next number is larger than the first number in the 5-digit array (i.e., the next product calculation). If so, then calculate the product. Otherwise, move onto the next number to add.</p>

<p>I think this last process is the most efficient, because each product that is actually calculated is guaranteed to be larger than the previous max product, since all else equal, replacing one number in a 5-digit product with a larger number will result in a larger number. This saves computation time and moves the determination of whether to calculate the product to a less computationally intensive task (comparing two numbers versus multiplication. At least, I think this is the case. I&#8217;m not super well versed in algorithm efficiency, but this makes sense to me at least.</p>

<p>The code I ended up implementing takes the most from the middle process. I could have extended the code further to make it more efficient, but I focused instead on making the code more object-oriented. My below code shows the three-step process I&#8217;m taking toward these problems - first, make it work with a smaller number, then make it work with the actual number, then refactor into an object.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># PROBLEM NUMBER 8</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># PROBLEM NAME</span>
</span><span class='line'><span class="c1"># Largest product in a series</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># PROBLEM DESCRIPTION</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Find the greatest product of five consecutive digits in the 1000-digit number.</span>
</span><span class='line'><span class="c1"># 73167176531330624919225119674426574742355349194934</span>
</span><span class='line'><span class="c1"># 96983520312774506326239578318016984801869478851843</span>
</span><span class='line'><span class="c1"># 85861560789112949495459501737958331952853208805511</span>
</span><span class='line'><span class="c1"># 12540698747158523863050715693290963295227443043557</span>
</span><span class='line'><span class="c1"># 66896648950445244523161731856403098711121722383113</span>
</span><span class='line'><span class="c1"># 62229893423380308135336276614282806444486645238749</span>
</span><span class='line'><span class="c1"># 30358907296290491560440772390713810515859307960866</span>
</span><span class='line'><span class="c1"># 70172427121883998797908792274921901699720888093776</span>
</span><span class='line'><span class="c1"># 65727333001053367881220235421809751254540594752243</span>
</span><span class='line'><span class="c1"># 52584907711670556013604839586446706324415722155397</span>
</span><span class='line'><span class="c1"># 53697817977846174064955149290862569321978468622482</span>
</span><span class='line'><span class="c1"># 83972241375657056057490261407972968652414535100474</span>
</span><span class='line'><span class="c1"># 82166370484403199890008895243450658541227588666881</span>
</span><span class='line'><span class="c1"># 16427171479924442928230863465674813919123162824586</span>
</span><span class='line'><span class="c1"># 17866458359124566529476545682848912883142607690042</span>
</span><span class='line'><span class="c1"># 24219022671055626321111109370544217506941658960408</span>
</span><span class='line'><span class="c1"># 07198403850962455444362981230987879927244284909188</span>
</span><span class='line'><span class="c1"># 84580156166097919133875499200524063689912560717606</span>
</span><span class='line'><span class="c1"># 05886116467109405077541002256983155200055935729725</span>
</span><span class='line'><span class="c1"># 71636269561882670428252483600823257530420752963450</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># PROCESS</span>
</span><span class='line'><span class="c1"># =&gt; Convert Fixnum to String to Array</span>
</span><span class='line'><span class="c1"># =&gt; Go through first five numbers and find the product</span>
</span><span class='line'><span class="c1"># =&gt; Save the result in a &quot;result&quot; variable</span>
</span><span class='line'><span class="c1"># =&gt; Remove the first number (1) (unshift) and add the 6th number (push)</span>
</span><span class='line'><span class="c1"># =&gt; Find the product of the second set of 5 numbers</span>
</span><span class='line'><span class="c1"># =&gt; If the result is larger than the value of &quot;result&quot;, replace the result value. Otherwise, discard the latest result</span>
</span><span class='line'><span class="c1"># =&gt; Repeat steps 3 to 5 until the end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># =&gt; With each number that is removed and added, check if the number being added is greater than the number being removed. If so, calculate the product.</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># ANSWER</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># =&gt; 40824</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;pry&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># =&gt; METHOD 1</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># num = 4938294829384</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># num_array = num.to_s.split(&quot;&quot;).collect { |i| i.to_i }</span>
</span><span class='line'><span class="c1"># iterations = num_array.length - 5</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># start = 0</span>
</span><span class='line'><span class="c1"># finish = 4</span>
</span><span class='line'><span class="c1"># product_array = []</span>
</span><span class='line'><span class="c1"># max_product = 0</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># (0..iterations).each do |i|</span>
</span><span class='line'><span class="c1">#   sub_array = (start..finish).collect { |n| num_array[n] }</span>
</span><span class='line'><span class="c1">#   product = sub_array.inject(1) { |result, num| result * num }</span>
</span><span class='line'><span class="c1">#   product_array &lt;&lt; product</span>
</span><span class='line'><span class="c1">#   if product &gt; max_product</span>
</span><span class='line'><span class="c1">#     max_product = product</span>
</span><span class='line'><span class="c1">#   end</span>
</span><span class='line'><span class="c1">#   start += 1</span>
</span><span class='line'><span class="c1">#   finish += 1</span>
</span><span class='line'><span class="c1"># end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># =&gt; METHOD 2</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># num = &quot;73167176531330624919225119674426574742355349194934</span>
</span><span class='line'><span class="c1"># 96983520312774506326239578318016984801869478851843</span>
</span><span class='line'><span class="c1"># 85861560789112949495459501737958331952853208805511</span>
</span><span class='line'><span class="c1"># 12540698747158523863050715693290963295227443043557</span>
</span><span class='line'><span class="c1"># 66896648950445244523161731856403098711121722383113</span>
</span><span class='line'><span class="c1"># 62229893423380308135336276614282806444486645238749</span>
</span><span class='line'><span class="c1"># 30358907296290491560440772390713810515859307960866</span>
</span><span class='line'><span class="c1"># 70172427121883998797908792274921901699720888093776</span>
</span><span class='line'><span class="c1"># 65727333001053367881220235421809751254540594752243</span>
</span><span class='line'><span class="c1"># 52584907711670556013604839586446706324415722155397</span>
</span><span class='line'><span class="c1"># 53697817977846174064955149290862569321978468622482</span>
</span><span class='line'><span class="c1"># 83972241375657056057490261407972968652414535100474</span>
</span><span class='line'><span class="c1"># 82166370484403199890008895243450658541227588666881</span>
</span><span class='line'><span class="c1"># 16427171479924442928230863465674813919123162824586</span>
</span><span class='line'><span class="c1"># 17866458359124566529476545682848912883142607690042</span>
</span><span class='line'><span class="c1"># 24219022671055626321111109370544217506941658960408</span>
</span><span class='line'><span class="c1"># 07198403850962455444362981230987879927244284909188</span>
</span><span class='line'><span class="c1"># 84580156166097919133875499200524063689912560717606</span>
</span><span class='line'><span class="c1"># 05886116467109405077541002256983155200055935729725</span>
</span><span class='line'><span class="c1"># 71636269561882670428252483600823257530420752963450&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># num_array = num.split(&quot;&quot;).collect { |i| i.to_i }</span>
</span><span class='line'><span class="c1"># iterations = num_array.length - 5</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># start = 0</span>
</span><span class='line'><span class="c1"># finish = 4</span>
</span><span class='line'><span class="c1"># product_array = []</span>
</span><span class='line'><span class="c1"># max_product = 0</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># (0..iterations).each do |i|</span>
</span><span class='line'><span class="c1">#   sub_array = (start..finish).collect { |n| num_array[n] }</span>
</span><span class='line'><span class="c1">#   product = sub_array.inject(1) { |result, num| result * num }</span>
</span><span class='line'><span class="c1">#   product_array &lt;&lt; product</span>
</span><span class='line'><span class="c1">#   if product &gt; max_product</span>
</span><span class='line'><span class="c1">#     max_product = product</span>
</span><span class='line'><span class="c1">#   end</span>
</span><span class='line'><span class="c1">#   start += 1</span>
</span><span class='line'><span class="c1">#   finish += 1</span>
</span><span class='line'><span class="c1"># end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># =&gt; METHOD 3 (Object Orientation)</span>
</span><span class='line'>
</span><span class='line'><span class="n">num</span> <span class="o">=</span> <span class="s2">&quot;73167176531330624919225119674426574742355349194934</span>
</span><span class='line'><span class="s2">96983520312774506326239578318016984801869478851843</span>
</span><span class='line'><span class="s2">85861560789112949495459501737958331952853208805511</span>
</span><span class='line'><span class="s2">12540698747158523863050715693290963295227443043557</span>
</span><span class='line'><span class="s2">66896648950445244523161731856403098711121722383113</span>
</span><span class='line'><span class="s2">62229893423380308135336276614282806444486645238749</span>
</span><span class='line'><span class="s2">30358907296290491560440772390713810515859307960866</span>
</span><span class='line'><span class="s2">70172427121883998797908792274921901699720888093776</span>
</span><span class='line'><span class="s2">65727333001053367881220235421809751254540594752243</span>
</span><span class='line'><span class="s2">52584907711670556013604839586446706324415722155397</span>
</span><span class='line'><span class="s2">53697817977846174064955149290862569321978468622482</span>
</span><span class='line'><span class="s2">83972241375657056057490261407972968652414535100474</span>
</span><span class='line'><span class="s2">82166370484403199890008895243450658541227588666881</span>
</span><span class='line'><span class="s2">16427171479924442928230863465674813919123162824586</span>
</span><span class='line'><span class="s2">17866458359124566529476545682848912883142607690042</span>
</span><span class='line'><span class="s2">24219022671055626321111109370544217506941658960408</span>
</span><span class='line'><span class="s2">07198403850962455444362981230987879927244284909188</span>
</span><span class='line'><span class="s2">84580156166097919133875499200524063689912560717606</span>
</span><span class='line'><span class="s2">05886116467109405077541002256983155200055935729725</span>
</span><span class='line'><span class="s2">71636269561882670428252483600823257530420752963450&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Product</span>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:number</span><span class="p">,</span> <span class="ss">:set</span><span class="p">,</span> <span class="ss">:start</span><span class="p">,</span> <span class="ss">:finish</span><span class="p">,</span> <span class="ss">:max_product</span><span class="p">,</span> <span class="ss">:product_array</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">set</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@set</span> <span class="o">=</span> <span class="n">set</span>
</span><span class='line'>    <span class="vi">@start</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="vi">@finish</span> <span class="o">=</span> <span class="n">set</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'>    <span class="vi">@max_product</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="vi">@product_array</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">create_array</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">i</span><span class="o">.</span><span class="n">to_i</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">iteration_count</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">create_array</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="nb">self</span><span class="o">.</span><span class="n">set</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">find_max_product</span>
</span><span class='line'>    <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.self</span><span class="o">.</span><span class="n">iteration_count</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>      <span class="n">sub_array</span> <span class="o">=</span> <span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">.self</span><span class="o">.</span><span class="n">finish</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">n</span><span class="o">|</span> <span class="nb">self</span><span class="o">.</span><span class="n">create_array</span><span class="o">[</span><span class="n">n</span><span class="o">]</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">product</span> <span class="o">=</span> <span class="n">sub_array</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">result</span><span class="p">,</span> <span class="n">num</span><span class="o">|</span> <span class="n">result</span> <span class="o">*</span> <span class="n">num</span> <span class="p">}</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">max_product</span> <span class="o">=</span> <span class="n">product</span> <span class="k">if</span> <span class="nb">self</span><span class="o">.</span><span class="n">max_product_compare</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">finish</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">max_product</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">max_product_compare</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</span><span class='line'>    <span class="kp">true</span> <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="nb">self</span><span class="o">.</span><span class="n">max_product</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">p</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span class='line'><span class="nb">p</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">num</span>
</span><span class='line'><span class="nb">p</span><span class="o">.</span><span class="n">find_max_product</span>
</span><span class='line'>
</span><span class='line'><span class="nb">binding</span><span class="o">.</span><span class="n">pry</span>
</span></code></pre></td></tr></table></div></figure>


<p>As I mentioned above, don&#8217;t be intimidated by the math parts of Project Euler. In retrospect, I wish I had started doing these problems earlier on in the semester, but its never too late to get some good mental exercise in.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[TRUE Object-Oriented Design]]></title>
    <link href="http://eewang.github.com/blog/2013/04/13/custom-activerecord-queries-in-rails/"/>
    <updated>2013-04-13T11:23:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/04/13/custom-activerecord-queries-in-rails</id>
    <content type="html"><![CDATA[<p>Avi always stresses that being a good developer is about more than just being a good coder. Like all professions, coding is only part of the job. What&#8217;s arguably more important than coding are the soft skills that transcend any individual profession. Skills like communication, empathy, diligence and hard work. All good professional jobs help build these skills, and software development is no different.</p>

<!--more-->


<p>But building those skills aren&#8217;t easy, especially when applied to the domain of coding. Clearly and succinctly explaining the internals of a codebase to a newbie is really difficult; it requires not only communication skills but also empathy and patience. As I&#8217;ve been learning how to code, I&#8217;m also trying to broaden my understanding of technology generally through reading, writing and engaging in the community (e.g., meetups, hackathons). Work-work balance is critical; while its important to code most every day when learning the skill, its also important to not just code. Regular coding enables me to get deep into the weeds and determine exactly how to properly route requests through my application, while reading and blogging helps me look at code from a high-level and develop a high-level understanding of software design and structure.</p>

<p>I&#8217;ve started to think of good design like a mountain range. The most abstract/least concrete layers are the most foundational to the application - the base of the mountain, if you will - whereas the least abstract/most concrete layers are the items that you actually see - the peaks. Each peak might represent a different component of your application, yet the base of the mountain represents the shared functionality or code patterns between the peaks. In looking at a mountain range from afar, no one can perceive the geological complexity of the sandstone or granite that allow the peaks to reach the sky. In the same way, good application design hides the complex inner workings of a program, yet it is this complexity that enables the public interface of an well-built application to work so seamlessly. As our teacher Bob Whitney said, the job of a developer is to take in complexity and deliver simplicity.</p>

<p>Admittedly, the mountain range metaphor is a bit contrived, but the same effective design pattern can be seen in other spheres, both natural and artificial. A rainforest&#8217;s beauty is seen from the treetops, but the complexity deep within the roots and vines that create an interlocking and co-dependent ecosystem and enable the treetops to extend high above the earth is hidden from the external observer. A well-functioning corporation requires harmony between its many internal groups in order to provide a service or product to its customers effectively. Software design just takes these common patterns of loose coupling, modularity and composition and applies them in the context of objects, classes and methods.</p>

<p>One book that I&#8217;ve recently finished reading that covers software design best practices is &#8220;Practical Object Oriented Design in Ruby&#8221; by Sandi Metz.
In POODR (her own acronym), Sandi Metz expresses these design patterns in a pithy and effective manner, complete with code examples, comparisons of good and bad design patterns and a common example of designing a bike shop application that weaves the 9 chapters together. POODR is an eminently readable book, and Ms. Metz does a remarkable job balancing deep dives into code with plain English explanations of good application design. As an aside, Ms. Metz&#8217;s day job is as an application developer for my alma mater, Duke University, which makes her all the more awesome.</p>

<p>Here are a few of her most quotable quotables and a few thoughts on how to consider her advice:</p>

<blockquote><p>Code should be transparent, reasonable, usable and exemplary.</p></blockquote>


<p>Sandi Metz is perhaps best known for this pithy guide on how to write code. Programs should be easily understandable, well-suited for their purpose, navigable and malleable and just awesome. TRUE is a useful north star for good code.</p>

<blockquote><p>Depend on things that change less often than you do.</p></blockquote>


<p>Dependencies in code are often unavoidable. Thus, what matters most is picking the right dependencies rather than trying to write entirely dependency-free code. Create dependencies that are manageable by ensuring that classes and objects that will likely change in the future should have proportionately fewer dependencies than code blocks that are more stable. The Ruby core library is a great example of this - it is better to build objects that depend on the String class, for example, than depend on an internal, domain-specific class, since the Ruby String class is pretty well-established and less likely to change going forward.</p>

<p>In a similar vein&#8230;</p>

<blockquote><p>Depend on behavior, not data.</p></blockquote>


<p>Data can take many different formats. A lot of coding is about taking one data item and cutting it up a hundred different ways before its actually displayed to the user. Thus, data will change frequently relative to behavior, which tends to be more consistent. Think of data as rows and behavior as columns in a database - its easier to grow a database vertically than horizontally. This means that its better to depend on behavior rather than data, because behavior is less likely to change.</p>

<blockquote><p>Create public methods that allow senders to get what they want without knowing how your class implements its behavior.</p></blockquote>


<p>Classes should have a well defined public API that enables interaction with other objects without knowing too much about those objects. One example that Sandi Metz uses is the notion of polymorphic interfaces, which are basically methods that can iteract with multiple data types (e.g., arrays or hashes). A common pitfall among new developers is designing methods that only take in a single data type. This requires a class B that might interact with class A to know what type of data class A expects. Oftentimes, its not class B&#8217;s responsibility to know what data class A expects; class A&#8217;s public method should have a polymorphic interface to lessen the dependencies between the two classes.</p>

<blockquote><p>&#8220;This tension between the costs of concretion and the costs of abstraction is fundamental to object-oriented design. Concrete code is easy to understand but costly to extend. Abstract code may initially seem more obscure but, once understood, is far easier to change. Use of a duck type moves your code along the scale from more concrete to more abstract, making the code easier to extend but casting a veil over the underlying class of the duck.&#8221;</p></blockquote>


<p>I love this quote in POODR because it highlights an underlying tradeoff that developers consider whenever refactoring code and applying the priciples of good object-oriented design. On the one end of the spectrum is concrete code that relies on well-defined dataset. On the other end is highly abstract code (e.g., methods that write methods via metaprogramming) that is more powerful and flexible than concrete code, but also often less readable to the untrained eye or freshman developer. A duck type is an object that can be of any type and used within function calls. I&#8217;m sure that&#8217;s not the technical definition, but to me, I think of duck types as abstract objects that can take many different forms, and so methods that can accept duck types need to be written abstractly in order to function properly.</p>

<blockquote><p>&#8220;The ability to tolerate ambiguity about the class of an object is the hallmark of a confident designer. Once you begin to treat your objects as if they are defined by their behavior rather than by their class, you enter into a new realm of expressive<br/>flexible design.&#8221;</p></blockquote>


<p>Fundamental to Sandi Metz&#8217;s software design philosophy seems to be the focus on defining behavior rather than data or data types. I like this quote because it focuses on building a flexible product that can adapt to whatever the future holds for an application. Early on in the development process, ambiguity reigns supreme since programmers cannot know what the product will eventually look like. Thus, a good developer and application designer should be able tolerate and accept that uncertainty and design around the problem. Building abstract frameworks to define object behavior enables an application to grow iteratively and organically as the product specifications change.</p>

<p>One thing I learned from the book is that different tools exist in software design to address different problems. The use of class inheritance, for example, should be used in some instances whereas modules and duck types should be used in others. Its difficult to go into a full example in the length of a blog post, but I would especially recommend reading chapters 5 through 8 about duck typing, inheritance, behavior sharing via modules and object composition. Sandi Metz does a great job of mixing in code examples along with good explanations of the high-level thought process of the pros and cons of each programming technique. Not every tool is right for every job, and so a hallmark of a good developer is being able to spot which tools are right for which jobs.</p>

<p>A lot of being a more experienced developer seems to revolve around this spidey sense about coding design patterns. Avi demonstrates this regularly when he&#8217;ll spend just a few minutes flying between levels of abstraction that take us beginners hours to implement ourselves. In fact, experience in most any profession or skillset can be reflected in the &#8220;sixth sense&#8221; someone has about recognizing patterns. An experienced trader can front-run the market because he or she &#8220;senses&#8221; that prices will move in a certain direction. A branding expert can quickly conceptualize a marketing campaign because he or she can immediately grasp the underlying nature of the message a client wants to convey. In the same way, experience as a developer means that you get better at spotting patterns in code. POODR aims to provide beginners with a jumpstart in finding those patterns.</p>

<p>Two other Ruby/Rails books that I&#8217;m reading are &#8220;Rails Antipatterns&#8221; by Chad Pytel and Tammer Saleh and &#8220;Metaprogramming Ruby&#8221; by Paolo Perrotta. I&#8217;m hoping to write a post on those books as well in the coming week or two, so stay tuned.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building ViewFinder (Flatiron - Week 9)]]></title>
    <link href="http://eewang.github.com/blog/2013/04/07/building-viewfinder-flatiron-week-9/"/>
    <updated>2013-04-07T14:42:00-04:00</updated>
    <id>http://eewang.github.com/blog/2013/04/07/building-viewfinder-flatiron-week-9</id>
    <content type="html"><![CDATA[<p>The majority of this past week was spent building <a href="http://viewfinder.io" target="_blank">ViewFinder</a>, which is a Rails app that leverages the Instagram API to enable users to guess where photos were taken and gamefies Instagram photo feeds. Building ViewFinder along with <a href="http://www.erinandcode.com" target="_blank">Erin Lee</a> and <a href="http://jlarusso.github.io" target="_blank">Jesse LaRusso</a> has been a pretty great experience; we got way farther than I had expected initially for the NYC on Rails presentation. Looking back at our Trello board, we defined our MVP for the presentation as an app where users could browse tagged photos and write in the address or intersection where they think the photo was taken. What we ended up with was much more than that, and more visually appealing than I could have imagined initially.</p>

<!--more-->


<p><strong>1) Brainstorming and ideation</strong></p>

<p>The idea for ViewFinder came from the View From Your Window (VFYW) game that the blogger Andrew Sullivan has on his blog, <a href="http://dish.andrewsullivan.com/" target="_blank">The Daily Dish</a>. If you haven&#8217;t read the Daily Dish, you should start (and pay for the privilege!). Sully is a coherent and reasoned blogger, and his writing covers a large swath of topics, from public policy and politics, to business, to arts and literature. For his VFYW game, readers will send him photos of their view outside their window and since his readership spans the globe, the photos tend to be from far-flung regions like Japan, Indonesia or Estonia. I&#8217;ve never played the game, because the amount of context clues provided by a VFYW photo are not enough for me to have a reasoned guess of where the photo was taken, given the global scope. However, I&#8217;ve always thought that the concept of the game was fun, and that it could be made more accessible to the average person by adding context, localizing the game and making it social.</p>

<p>I had initially planned to pursue this as a side project during the Flatiron program. Separately, Jesse, Erin and I were considering doing a project for The Disruptor Cup, which is a NYC hackathon that focuses on emergency preparedness. We had discussed an idea centered on analyzing government spending data in the aftermath of Hurricane Sandy and using the d3 Javascript library for data visualization as the interface for users to interact with the data. However, that idea didn&#8217;t get too far, as just getting up to speed with the d3 library such that we could build complex data visualizations presented a pretty steep learning curve. And given the timing of the Disruptor Cup (early/mid-April) relative to our actual class projects, we decided to punt on the hackathon. We figured that there will always be other hackathons to participate in (and civic data is a particular passion for Jesse and I), and we didn&#8217;t want to get too bogged down such that our in-class work quality would fall.</p>

<p>We explored a few other data visualization ideas for the NYC on Rails presentation. Most of these centered on using the NYC Open Data API to build a data visualization or map. However, we couldn&#8217;t quite figure out what we could build that would be a great learning experience, be a functional product and, most importantly, actually be fun to build. We knew that we wanted to work with data and APIs in some form, do something with maps and build an the end product with a well-designed front end.</p>

<p>In the end, I proposed ViewFinder as our NYC on Rails presentation. Erin and Jesse seemed to warm up to the idea pretty quickly, and we brainstormed a lot of ideas and features that we could build. We ended up agreeing to focus on building out a location-based game, where users could guess where Instagram photos were taken by geographic area in New York. Initially, we had Union Square, Times Square and 30 Rock as our main areas, but those gradually evolved into Midtown Manhattan, Downtown Manhattan and Downtown Brooklyn.</p>

<p><strong>2) Schema, design and gameplay</strong></p>

<p>I was happy that I was able to apply various programming techniques and tools that Avi/Bob/Blake have covered over the past few weeks. The two that come most clearly to mind are metaprogramming and asynchronous background job processing. Metaprogramming is a really useful technique to write methods that write their own methods. They are most applicable to code abstract patterns that vary by the data they accept rather than the actual methods that are applied to the data.</p>

<p>The area where I used metaprogramming most actively was in designing the Instagram API calls and connecting that to the gameplay. For the Instagram API calls, there are a few different ways to access the API - you can search by tag, by geographic location, by user or by popular media. For each of these calls, I needed to filter the data to remove any images that were not geotagged, as non-geotagged photos would be useless in a location guessing game. Thus, in my Instagram wrapper class - which wraps the Instagram gem, which itself directly accesses the Instagram API - I have the following code:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># instagram_wrapper.rb</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">acts_as_locatable</span><span class="p">(</span><span class="o">*</span><span class="n">queries</span><span class="p">)</span>
</span><span class='line'>  <span class="n">queries</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">query</span><span class="o">|</span>
</span><span class='line'>    <span class="n">define_method</span> <span class="s2">&quot;filter_</span><span class="si">#{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span> <span class="o">|</span><span class="n">options</span><span class="o">|</span>
</span><span class='line'>      <span class="n">location_images</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">delete_if</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">i</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">nil?</span><span class="p">}</span>
</span><span class='line'>      <span class="n">location_images</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">acts_as_locatable</span> <span class="ss">:tag_recent_media</span><span class="p">,</span> <span class="ss">:media_search</span><span class="p">,</span> <span class="ss">:user_recent_media</span><span class="p">,</span> <span class="ss">:media_popular</span><span class="p">,</span> <span class="ss">:user_media_feed</span>
</span></code></pre></td></tr></table></div></figure>


<p>&#8220;acts_as_locatable&#8221; at the end of the above code block is a class method that takes in an arbitrary number of arguments and is executed at runtime. For each argument, it creates a method with the name of the argument prefixed with &#8220;filter_&#8221;. Each of these filter methods strip away the non-geotagged results of any of the Instagram API queries defined by the parameters passed to the acts_as_locatable class method. These methods flow into the photo model, which then takes the results of the filtered Instagram query and saves them to the database.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">acts_as_instagrammable</span><span class="p">(</span><span class="o">*</span><span class="n">queries</span><span class="p">)</span>
</span><span class='line'>  <span class="n">queries</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">query</span><span class="o">|</span>
</span><span class='line'>    <span class="n">define_singleton_method</span> <span class="s2">&quot;instagram_</span><span class="si">#{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span> <span class="o">|</span><span class="n">options</span><span class="o">|</span>
</span><span class='line'>      <span class="n">i</span> <span class="o">=</span> <span class="no">InstagramWrapper</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>      <span class="n">filtered_images</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;filter_</span><span class="si">#{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span><span class='line'>      <span class="n">filtered_images</span><span class="o">.</span><span class="n">collect</span> <span class="k">do</span> <span class="o">|</span><span class="n">pic</span><span class="o">|</span>
</span><span class='line'>        <span class="no">Photo</span><span class="o">.</span><span class="n">save_instagram_photos</span><span class="p">(</span><span class="n">pic</span><span class="p">)</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">acts_as_instagrammable</span> <span class="ss">:media_search</span><span class="p">,</span> <span class="ss">:tag_recent_media</span><span class="p">,</span> <span class="ss">:media_popular</span><span class="p">,</span> <span class="ss">:user_media_feed</span><span class="p">,</span> <span class="ss">:user_recent_media</span>
</span></code></pre></td></tr></table></div></figure>


<p>Like in the first code block, &#8220;acts_as_instagrammable&#8221; is a class method that creates a new instance of the Instagram wrapper, calls the relevant filtered Instagram API call and saves the photos to the database. This way, I know that whenever I want to get photos from Instagram, I can use their method names (e.g., tag_recent_media) and know that what I ultimately get back are instances of my photo database, which will only include geotagged items.</p>

<p>Finally, the below meta-method is the crux of the gameplay, and queries the database for photos while simultaneously initiating a background processing job via Sidekiq to get more data from Instagram.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">location_games</span><span class="p">(</span><span class="o">*</span><span class="n">games</span><span class="p">)</span>
</span><span class='line'>  <span class="n">games</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">game</span><span class="o">|</span>
</span><span class='line'>    <span class="n">define_method</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">game</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@game</span> <span class="o">=</span> <span class="n">game</span>
</span><span class='line'>      <span class="vi">@coordinates</span> <span class="o">=</span> <span class="no">LOCATION_GAMES</span><span class="o">[</span><span class="n">game</span><span class="o">.</span><span class="n">to_sym</span><span class="o">][</span><span class="ss">:coordinates</span><span class="o">]</span>
</span><span class='line'>      <span class="n">radius</span> <span class="o">=</span> <span class="no">LOCATION_GAMES</span><span class="o">[</span><span class="n">game</span><span class="o">.</span><span class="n">to_sym</span><span class="o">][</span><span class="ss">:radius</span><span class="o">]</span>
</span><span class='line'>      <span class="n">size</span> <span class="o">=</span> <span class="no">LOCATION_GAMES</span><span class="o">[</span><span class="n">game</span><span class="o">.</span><span class="n">to_sym</span><span class="o">][</span><span class="ss">:size</span><span class="o">]</span>
</span><span class='line'>      <span class="n">user</span> <span class="o">=</span> <span class="n">current_user</span>
</span><span class='line'>      <span class="vi">@photos</span> <span class="o">=</span> <span class="no">Photo</span><span class="o">.</span><span class="n">game_photos_random</span><span class="p">(</span><span class="vi">@coordinates</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</span><span class='line'>      <span class="vi">@photos</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span>
</span><span class='line'>        <span class="nb">p</span><span class="o">.</span><span class="n">locale_lat</span> <span class="o">=</span> <span class="no">LOCATION_GAMES</span><span class="o">[</span><span class="n">game</span><span class="o">.</span><span class="n">to_sym</span><span class="o">][</span><span class="ss">:coordinates</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'>        <span class="nb">p</span><span class="o">.</span><span class="n">locale_lon</span> <span class="o">=</span> <span class="no">LOCATION_GAMES</span><span class="o">[</span><span class="n">game</span><span class="o">.</span><span class="n">to_sym</span><span class="o">][</span><span class="ss">:coordinates</span><span class="o">][</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>        <span class="nb">p</span><span class="o">.</span><span class="n">save</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">create_game</span><span class="p">({</span><span class="ss">:game</span> <span class="o">=&gt;</span> <span class="vi">@game</span><span class="p">,</span> <span class="ss">:coordinates</span> <span class="o">=&gt;</span> <span class="vi">@coordinates</span><span class="p">,</span> <span class="ss">:photos</span> <span class="o">=&gt;</span> <span class="vi">@photos</span><span class="p">})</span>
</span><span class='line'>      <span class="vi">@start_photo</span> <span class="o">=</span> <span class="n">session</span><span class="o">[</span><span class="n">game</span><span class="o">][</span><span class="ss">:photos</span><span class="o">].</span><span class="n">empty?</span> <span class="p">?</span> <span class="mi">0</span> <span class="p">:</span> <span class="no">Photo</span><span class="o">.</span><span class="n">first_unguessed_photo</span><span class="p">(</span><span class="n">session</span><span class="o">[</span><span class="n">game</span><span class="o">][</span><span class="ss">:photos</span><span class="o">]</span><span class="p">,</span> <span class="n">current_user</span><span class="p">)</span>
</span><span class='line'>      <span class="vi">@guessed_count</span> <span class="o">=</span> <span class="vi">@photos</span><span class="o">.</span><span class="n">count</span> <span class="p">{</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span> <span class="nb">p</span><span class="o">.</span><span class="n">guessed_by?</span><span class="p">(</span><span class="n">current_user</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>      <span class="no">InstagramWorker</span><span class="o">.</span><span class="n">perform_async</span><span class="p">(</span><span class="vi">@coordinates</span><span class="p">)</span>
</span><span class='line'>      <span class="n">render</span> <span class="s2">&quot;index&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">location_games</span> <span class="ss">:downtown</span><span class="p">,</span> <span class="ss">:midtown</span><span class="p">,</span> <span class="ss">:downtown_brooklyn</span> <span class="c1">#, :world_trade, :dumbo</span>
</span></code></pre></td></tr></table></div></figure>


<p>The above block does a number of things, and is admittedly probably a decent candidate for additional refactoring. This meta-method creates a method for each game that is created. Initially, we just defined three games in a hash (not shown here) called LOCATION_GAMES, but eventually we think it would be cool for users to create their own games. For example, someone who is really into architecture or beautiful aboreal landscapes can tag photos on Instagram with #viewfinder and another tag and basically create themed games. Additionally, we imagine that this game can be replicated across most any geography, so we wanted to have a flexible design where you could quickly define the parameters of a game and have that flow into the application. Currently, games are defined within the context of a photo, but I think we are looking to break out games into their own game model and make ViewFinder more solidly object-oriented.</p>

<p>Anyways, the above code is activated when a user clicks on a location-based game on the ViewFinder landing page. For each game, the method will determine the game parameters (i.e., coordinates, radius and photo set size), go to the database and get a random set of photos that have not been guesesd by the logged in user, are tagged with #viewfinder or #vfyw and are within the defined radius of the coordinates. Simultaneously, the method will set off a background job to get more data from Instagram within the location parameters of the game. This way, as more people play and demand for a given game scales, the application should theoretically make more API calls and thus get more real-time data from Instagram, all without impacting the user experience as the arduous task of accessing the Instagram API and saving photos to the database is disassociated from the photos that are loaded on the front-end.</p>

<p>There are definitely many areas where we can do additional refactoring and clean up the code. One place specifically where I think we can do better is in using view helper methods more actively, as well as moving more logic to our controllers. With the NYC on Rails presentation coming up on Thursday, I&#8217;ll admit that we took a few shortcuts in the middle of the week just to get stuff working. In the next few weeks, I hope to go back through the code from start to finish and refactor extensively.</p>

<p>In terms of the front-end design of the application, we wanted to make the user interface highly visual and intuitive for new users to quickly get up to speed on the game. We went through several iterations of design that used various photo carousel options. We eventually rotated back to Twitter Bootstrap&#8217;s carousel, and I&#8217;m pretty happy with how the design ended up.</p>

<p><strong>3) Technical challenges</strong></p>

<p>Probably the biggest technical challenge that we faced was in figuring out how to use the Google Maps API to drag and drop a map marker that then posts to our guesses controller to create a photo location guess. We had to delve deeper into Javascript than we had previously in class, and we also learned how to use AJAX in the process. The map that is displayed when a user decides to guess on a photo is centered on the game that the user is playing. When a user decides to play the Midtown game, for example, the photos that get loaded into the game are tagged with the coordinates of the game origin. This way, when the guess map is loaded, the map is centered and zoomed in accordingly.</p>

<p>After figuring out how to load the map correctly, we needed to be able to post the coordinates of the map marker to create a guess. To do this, we used Javascript to recalculate the map marker coordinates whenever the map changed (the map marker automatically moves to the center of the map) and AJAX to create a guess with the respective coordinates when the user pressed &#8220;GUESS&#8221;. Then, when the next page is loaded (i.e., the guesses show page), the map contains a marker for each guess that has been made on that photo. Figuring out how to make Rails and Javascript play nice in terms of transferring data between the two was challenging, but now that we were able to do that successfully, it&#8217;s a great feeling to know that I now have that skill in my toolbelt.</p>

<p>Another challenge we faced was working with Instagram authentication and enabling users to sign-in via Instagram and display their user feed and friend feeds. This challenge tied in with the difficulty of designing a clean, intuitive user flow - from choosing a game all the way to viewing the results after making a guess. The first thing I tried to do actually when working on ViewFinder was to try and set up Instagram authentication. I used the Omniauth gem to do this, but it was a frustrating experience. I learned eventually that I was over-programming, in a sense, and needed to just let Omniauth take care of the authentication process. Building an intuitive user experience with Instagram authentication is still something we&#8217;re working on, and I think that making the gameplay more object-oriented will help in that regard.</p>

<p><strong>4) Future extensions</strong></p>

<p>I think it would be great to enable users to create their own games. Eventually, I&#8217;d like it for people passionate about sculptures, for example, to be able to take pictures across the globe and tag their pics with #sculpture and #viewfinder and have the application pick that up for their followers to guess where they&#8217;ve been. In general, I like the notion of themed games as a way to enable people that are passionate about whatever to better express that passion.</p>

<p>Also, it would be really cool if users could play timed games on ViewFinder, or challenge their friends to see who can best guess a set of 10 photos in a fixed amount of time. Another feature that I&#8217;d like to work on is to build out the analytics of the game and tap into the competitive nature of people. I&#8217;m a bit of a data analytics geek, and it would be super cool if we could use user data from the game to create cool data visualizations.</p>

<p>On the technical side, there is a certain amount of technical debt that got built up with the rush to deploy before the NYC on Rails presentation. I don&#8217;t think the debt is insurmountable, but the app can definitely benefit from some refactoring. Using view helpers more effectively, moving some code into modules for shared functionality and making gameplay more object-oriented are all changes that I think would make the codebase cleaner and the user experience more fluid.</p>

<p>I definitely would like to continue developing ViewFinder and building out new features. I&#8217;ve enjoyed the process of designing the product, working in a team and writing code. There&#8217;s an undefinable joy in having an idea and being able to execute on that idea and see the results. Like many creative ventures, coding is hard enough so that its always challenging, but its also accessible and progress is possible with concerted effort. And to steal a phrase from Avi, coding is all about taking complexity and delivering simplicity. A simple, sensible user interface hides the complexity within a codebase, and now being able to understand how that complexity creates simplicity has been fantastic.</p>
]]></content>
  </entry>
  
</feed>
